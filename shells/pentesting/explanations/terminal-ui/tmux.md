# Tmux - Terminal Multiplexer

## Overview
Tmux is a terminal multiplexer that allows you to:
- Create multiple terminal sessions
- Split terminal windows
- Detach and reattach sessions
- Manage persistent terminal environments
- Organize workflows efficiently

## Basic Usage

### Starting Tmux
```bash
# Start new session
tmux

# Start named session
tmux new -s mysession

# Start with command
tmux new -s devsession "vim"

# Attach to existing session
tmux attach -t mysession

# List sessions
tmux ls
```

### Session Management
```bash
# Detach from session
Ctrl+b d

# Kill session
tmux kill-session -t mysession

# Rename session
tmux rename-session -t oldname newname

# Switch to session
tmux switch -t sessionname
```

## Windows and Panes

### Window Management
```bash
# Create new window
Ctrl+b c

# Switch to next window
Ctrl+b n

# Switch to previous window
Ctrl+b p

# Switch to window by number
Ctrl+b 0-9

# List windows
Ctrl+b w

# Rename current window
Ctrl+b ,

# Close current window
Ctrl+b &
```

### Pane Management
```bash
# Split horizontally
Ctrl+b "

# Split vertically
Ctrl+b %

# Switch between panes
Ctrl+b arrow keys

# Switch between panes (next)
Ctrl+b o

# Close current pane
Ctrl+b x

# Resize pane
Ctrl+b Ctrl+arrow keys

# Rotate panes
Ctrl+b Ctrl+o
```

### Pane Layouts
```bash
# Cycle through layouts
Ctrl+b Space

# Even horizontal layout
Ctrl+b Alt+1

# Even vertical layout
Ctrl+b Alt+2

# Main horizontal layout
Ctrl+b Alt+3

# Main vertical layout
Ctrl+b Alt+4

# Tiled layout
Ctrl+b Alt+5
```

## Session Persistence

### Detaching and Reattaching
```bash
# Detach session
tmux detach

# Reattach to last session
tmux attach

# Reattach to specific session
tmux attach -t sessionname

# Detach other clients
tmux attach -d -t sessionname
```

### Background Sessions
```bash
# Start session in background
tmux new -d -s background

# Run command in background session
tmux new -d -s longrunning "long_running_command"

# Send commands to background session
tmux send-keys -t sessionname "command" C-m
```

## Configuration

### Configuration File
```bash
# Edit configuration file
nano ~/.tmux.conf

# Reload configuration
tmux source-file ~/.tmux.conf
```

### Basic Configuration
```bash
# ~/.tmux.conf

# Change prefix key
set -g prefix C-a
unbind C-b

# Enable mouse support
set -g mouse on

# Set default terminal
set -g default-terminal "screen-256color"

# Enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# Set window and pane numbering to start from 1
set -g base-index 1
setw -g pane-base-index 1
```

### Advanced Configuration
```bash
# Custom key bindings
bind-key r source-file ~/.tmux.conf \; display-message "Config reloaded"

# Split pane in current directory
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Create window in current directory
bind c new-window -c "#{pane_current_path}"

# Enable vi keys
setw -g mode-keys vi

# Copy mode settings
bind Escape copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
```

## Practical Workflows

### Development Environment
```bash
# Create development session
tmux new -s dev

# Split for editor and terminal
Ctrl+b c          # New window
Ctrl+b "          # Split horizontal
Ctrl+b %          # Split vertical

# Layout: IDE style
# Window 1: Editor (vim/nano)
# Window 2: Terminal for commands
# Window 3: Git/status monitoring
```

### Server Management
```bash
# Create server management session
tmux new -s servers

# Multiple server connections
Ctrl+b c          # New window for each server
ssh user@server1
Ctrl+b c
ssh user@server2

# Background monitoring
tmux new -d -s monitoring "htop"
tmux new -d -s logs "tail -f /var/log/syslog"
```

### Security Testing
```bash
# Security testing session
tmux new -s pentest

# Multiple tools in panes
Ctrl+b "          # Split horizontal
# Top pane: nmap scan
# Bottom pane: hydra attack

Ctrl+b c          # New window for web testing
Ctrl+b "          # Split
# Top pane: gobuster
# Bottom pane: nikto
```

## Copy and Paste

### Copy Mode
```bash
# Enter copy mode
Ctrl+b [

# Navigate (vi keys)
j/k - up/down lines
h/l - left/right characters
w/b - word forward/backward
g/G - beginning/end of buffer

# Start selection
Space

# End selection and copy
Enter

# Paste
Ctrl+b ]
```

### Clipboard Integration
```bash
# Enable system clipboard (requires xclip)
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -i -sel clip > /dev/null"

# Paste from system clipboard
bind C-v run "xclip -o -sel clip | tmux load-buffer - ; tmux paste-buffer"
```

## Status Bar

### Status Line Configuration
```bash
# Custom status bar
set -g status-left-length 50
set -g status-left "#[fg=green]#S:#W #[default]"
set -g status-right "#[fg=yellow]%Y-%m-%d %H:%M#[default]"

# Window status
set -g window-status-format "#I:#W#F"
set -g window-status-current-format "#[fg=red,bold]#I:#W#F#[default]"
```

### Color Schemes
```bash
# Basic color scheme
set -g status-bg black
set -g status-fg white
set -g window-status-current-bg red
set -g window-status-current-fg white

# Pane colors
set -g pane-border-fg green
set -g pane-active-border-fg yellow
```

## Automation and Scripting

### Session Scripts
```bash
#!/bin/bash
# Create development session automatically

SESSION="dev"

# Create session
tmux new-session -d -s "$SESSION"

# Create windows and panes
tmux new-window -t "$SESSION:1" -n "Editor"
tmux send-keys -t "$SESSION:1" "vim" C-m

tmux new-window -t "$SESSION:2" -n "Terminal"
tmux send-keys -t "$SESSION:2" "ls -la" C-m

tmux new-window -t "$SESSION:3" -n "Git"
tmux send-keys -t "$SESSION:3" "git status" C-m

# Attach to session
tmux attach-session -t "$SESSION"
```

### Automated Commands
```bash
# Send commands to specific sessions
tmux send-keys -t sessionname:windowname "command" C-m

# Create window with command
tmux new-window -t sessionname "command"

# Split window with command
tmux split-window -t sessionname "command"
```

## Advanced Features

### Nested Tmux Sessions
```bash
# Handle nested sessions
bind-key a send-prefix

# Change prefix for nested sessions
set -g prefix C-a
```

### Templates and Profiles
```bash
# Save session layout
tmux list-windows -t sessionname > session_layout.txt

# Restore session (complex, requires scripting)
# See tmux-resurrect plugin for easier session saving
```

### Remote Pairing
```bash
# Allow multiple users to connect to same session
tmux -S /tmp/tmuxsocket new -s sharedsession

# Other users connect with:
tmux -S /tmp/tmuxsocket attach -t sharedsession
```

## Plugins

### TPM (Tmux Plugin Manager)
```bash
# Install TPM
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# Add to ~/.tmux.conf
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
run '~/.tmux/plugins/tpm/tpm'

# Install plugins
tmux prefix + I

# Update plugins
tmux prefix + U
```

### Popular Plugins
```bash
# tmux-resurrect - save/restore sessions
set -g @plugin 'tmux-plugins/tmux-resurrect'

# tmux-yank - better clipboard integration
set -g @plugin 'tmux-plugins/tmux-yank'

# tmux-fzf - fuzzy finding
set -g @plugin 'sainnhe/tmux-fzf'
```

## Troubleshooting

### Common Issues
```bash
# Kill unresponsive session
tmux kill-session -t sessionname

# Force detach
tmux detach-client -s sessionname

# List all clients
tmux list-clients -t sessionname

# Show server info
tmux info
```

### Recovery
```bash
# Recover from crash
tmux kill-server
tmux start-server

# Clean up sockets
rm -f /tmp/tmux-*

# Fix display issues
tmux attach -d
```

## Tips
- Use meaningful session and window names
- Learn the prefix key alternatives (C-a vs C-b)
- Enable mouse support for easier pane management
- Save frequently used layouts as scripts
- Use copy mode for efficient text manipulation
- Configure status bar for useful information
- Use plugins to extend functionality
- Set up automatic session creation for common workflows
- Use tmux for long-running commands on remote servers
- Combine with tmuxinator for complex session management