# Binwalk - Firmware Analysis Tool

## Overview
Binwalk is a firmware analysis tool for:
- Extracting firmware files
- Analyzing embedded systems
- Finding hidden files and data
- Reverse engineering firmware
- Signature scanning
- File carving

## Basic Usage

### Simple Analysis
```bash
# Scan a file
binwalk firmware.bin

# Show file signatures
binwalk firmware.bin --signature

# Extract files
binwalk firmware.bin --extract

# Verbose output
binwalk firmware.bin -v
```

### Basic Options
```bash
# Scan with entropy analysis
binwalk firmware.bin --entropy

# Extract to specific directory
binwalk firmware.bin --extract --directory=output

# Show file size
binwalk firmware.bin --length

# Show hexadecimal dump
binwalk firmware.bin --hexdump
```

## Signature Analysis

### Magic Signatures
```bash
# Scan for known file types
binwalk firmware.bin -B

# Show only signatures
binwalk firmware.bin --signature

# Use custom magic file
binwalk firmware.bin --magic=custom.magic

# Exclude specific signatures
binwalk firmware.bin --exclude="png,jpg,gif"
```

### Signature Matching
```bash
# Show detailed signature information
binwalk firmware.bin -vv

# Scan specific file types
binwalk firmware.bin --raw="\\x7fELF"

# Use regular expressions
binwalk firmware.bin --grep="password|secret"
```

## Extraction

### Automatic Extraction
```bash
# Extract all known file types
binwalk firmware.bin --extract

# Extract recursively
binwalk firmware.bin --extract --recursive

# Extract with Matryoshka protection
binwalk firmware.bin --extract --matryoshka

# Extract to specific directory
binwalk firmware.bin --extract --directory=/tmp/extracted
```

### Manual Extraction
```bash
# Extract from specific offset
binwalk firmware.bin --extract --dd=firmware:0x1000

# Extract specific size
binwalk firmware.bin --extract --size=1000000

# Extract by signature
binwalk firmware.bin --extract --signature="gzip"
```

## Entropy Analysis

### Entropy Plotting
```bash
# Generate entropy plot
binwalk firmware.bin --entropy

# Save entropy plot
binwalk firmware.bin --entropy --plot

# Specify entropy block size
binwalk firmware.bin --entropy --block=1024

# Entropy analysis with extraction
binwalk firmware.bin --entropy --extract
```

### Entropy Interpretation
```bash
# High entropy areas (encrypted/compressed)
# Low entropy areas (plaintext/config)
# Patterns in entropy indicate structure
```

## Advanced Scanning

### String Extraction
```bash
# Extract ASCII strings
binwalk firmware.bin --strings

# Extract Unicode strings
binwalk firmware.bin --strings --unicode

# Set minimum string length
binwalk firmware.bin --strings --length=8

# Extract strings to file
binwalk firmware.bin --strings > strings.txt
```

### Code Analysis
```bash
# Scan for executable code
binwalk firmware.bin --opcodes

# Disassemble extracted code
binwalk firmware.bin --disasm

# Show architecture information
binwalk firmware.bin --arch
```

### File System Analysis
```bash
# Extract file systems
binwalk firmware.bin --extract --filesystem

# SquashFS extraction
binwalk firmware.bin --extract --squashfs

# CramFS extraction
binwalk firmware.bin --extract --cramfs
```

## Compression Analysis

### Compressed Files
```bash
# Find compressed archives
binwalk firmware.bin --signature | grep -i "compress"

# Extract gzip files
binwalk firmware.bin --extract --gzip

# Extract zip files
binwalk firmware.bin --extract --zip

# Decompress LZMA
binwalk firmware.bin --extract --lzma
```

### Custom Decompression
```bash
# Use custom decompression
binwalk firmware.bin --decompress

# Specify decompression tool
binwalk firmware.bin --decompress --tool=7z
```

## Firmware Analysis

### Router Firmware
```bash
# Analyze router firmware
binwalk router_firmware.bin --extract --recursive

# Look for configuration files
binwalk router_firmware.bin --grep="config|password|admin"

# Extract web interface
binwalk router_firmware.bin --extract --signature="html"
```

### IoT Device Firmware
```bash
# IoT device analysis
binwalk iot_firmware.bin --entropy --extract

# Find network configurations
binwalk iot_firmware.bin --strings | grep -E "(192\.168|10\.|172\.)"

# Look for credentials
binwalk iot_firmware.bin --strings | grep -E "(password|key|secret)"
```

## File Carving

### Data Recovery
```bash
# Carve specific file types
binwalk image.dd --signature="jpg,png,gif"

# Carve all files
binwalk image.dd --extract --signature

# Carve with size limits
binwalk image.dd --extract --maxsize=1000000
```

### Image Analysis
```bash
# Analyze disk images
binwalk disk.img --extract

# Look for filesystem signatures
binwalk disk.img --signature | grep -E "(ext4|ntfs|fat)"

# Extract partition tables
binwalk disk.img --extract --signature="partition"
```

## Automation and Scripting

### Batch Processing
```bash
#!/bin/bash
# Batch firmware analysis

for firmware in *.bin; do
    echo "Analyzing $firmware..."
    mkdir -p "extracted_${firmware%.bin}"
    binwalk "$firmware" --extract --directory="extracted_${firmware%.bin}"
    binwalk "$firmware" --entropy --plot
done
```

### Reporting
```bash
#!/bin/bash
# Generate analysis report

firmware="$1"
output="report_${firmware%.bin}.txt"

echo "Firmware Analysis Report" > "$output"
echo "========================" >> "$output"
echo "File: $firmware" >> "$output"
date >> "$output"
echo "" >> "$output"

echo "Signature Analysis:" >> "$output"
binwalk "$firmware" --signature >> "$output"
echo "" >> "$output"

echo "String Analysis:" >> "$output"
binwalk "$firmware" --strings --length=8 >> "$output"
echo "" >> "$output"

echo "Entropy Analysis:" >> "$output"
binwalk "$firmware" --entropy >> "$output"
```

## Integration with Other Tools

### Firmware Modding
```bash
# Extract firmware
binwalk firmware.bin --extract

# Modify files
cd _firmware.bin.extracted/
# [Make modifications]

# Rebuild firmware
# Use appropriate rebuild tool (depends on firmware type)
```

### Security Analysis
```bash
# Extract and analyze
binwalk firmware.bin --extract --recursive

# Run vulnerability scanner on extracted files
find _firmware.bin.extracted/ -type f -exec grep -l "password\|secret" {} \;

# Analyze web interfaces
find _firmware.bin.extracted/ -name "*.html" -exec grep -l "admin\|login" {} \;
```

## Practical Examples

### Router Firmware Analysis
```bash
# Quick analysis
binwalk router_firmware.bin

# Full extraction
binwalk router_firmware.bin --extract --recursive --directory=router_analysis

# Find admin credentials
binwalk router_firmware.bin --strings | grep -i admin

# Entropy analysis for encryption
binwalk router_firmware.bin --entropy --plot
```

### IoT Device Security Assessment
```bash
# Extract firmware
binwalk iot_device.bin --extract --matryoshka

# Search for default credentials
binwalk iot_device.bin --strings | grep -E "(admin:admin|root:root|password:123)"

# Look for network services
binwalk iot_device.bin --strings | grep -E "(telnet|ssh|http|ftp)"

# Check for hardcoded keys
binwalk iot_device.bin --strings | grep -E "(private_key|public_key|certificate)"
```

### Malware Analysis
```bash
# Suspicious firmware
binwalk suspicious.bin --extract --recursive

# Look for network indicators
binwalk suspicious.bin --strings | grep -E "(http://|ftp://|\\d+\\.\\d+\\.\\d+\\.\\d+)"

# Find suspicious strings
binwalk suspicious.bin --strings | grep -E "(password|backdoor|rootkit)"

# Entropy analysis
binwalk suspicious.bin --entropy
```

## Advanced Options

### Custom Signatures
```bash
# Create custom magic file
echo "0 string CUSTOM_SIG Custom File Type" > custom.magic

# Use custom signatures
binwalk file.bin --magic=custom.magic

# Add to default signatures
cp custom.magic ~/.local/share/binwalk/magic/
```

### Output Control
```bash
# JSON output
binwalk firmware.bin --json > analysis.json

# CSV output
binwalk firmware.bin --csv > analysis.csv

# Save log
binwalk firmware.bin --log=analysis.log
```

## Tips
- Always start with signature scanning
- Use entropy analysis to identify encrypted areas
- Extract recursively to get all nested files
- Look for configuration files and credentials
- Use string extraction for quick insights
- Document your analysis process
- Work in extracted directories, not original firmware
- Use appropriate tools for extracted file types
- Consider legal implications when analyzing proprietary firmware
- Backup original firmware before making any modifications