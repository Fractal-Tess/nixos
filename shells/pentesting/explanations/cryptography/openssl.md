# OpenSSL - Cryptography Toolkit

## Overview
OpenSSL is a robust cryptography toolkit providing:
- SSL/TLS implementation
- Certificate management
- Cryptographic operations
- Key generation and management
- Data encryption/decryption
- Hashing and digest functions

## Certificate Operations

### Generate Keys
```bash
# Generate RSA private key
openssl genrsa -out private.key 2048

# Generate RSA private key with password
openssl genrsa -des3 -out private.key 2048

# Generate ECC private key
openssl ecparam -name secp256r1 -genkey -noout -out ec_private.key

# Generate DH parameters
openssl dhparam -out dhparam.pem 2048
```

### Certificate Signing Requests (CSR)
```bash
# Generate CSR from private key
openssl req -new -key private.key -out request.csr

# Generate CSR with subject info
openssl req -new -key private.key -out request.csr -subj "/C=US/ST=State/L=City/O=Organization/CN=domain.com"

# Generate self-signed certificate
openssl req -new -x509 -key private.key -out certificate.crt -days 365

# Generate CSR with config file
openssl req -new -key private.key -out request.csr -config openssl.cnf
```

### Certificate Information
```bash
# Display certificate information
openssl x509 -in certificate.crt -text -noout

# Display certificate subject
openssl x509 -in certificate.crt -noout -subject

# Display certificate issuer
openssl x509 -in certificate.crt -noout -issuer

# Check certificate expiration
openssl x509 -in certificate.crt -noout -dates

# Verify certificate
openssl verify certificate.crt
```

### Certificate Conversion
```bash
# Convert PEM to DER
openssl x509 -in certificate.crt -outform der -out certificate.der

# Convert DER to PEM
openssl x509 -in certificate.der -inform der -out certificate.pem

# Convert PEM to P12
openssl pkcs12 -export -in certificate.crt -inkey private.key -out certificate.p12

# Convert P12 to PEM
openssl pkcs12 -in certificate.p12 -nodes -out certificate.pem
```

## Encryption and Decryption

### Symmetric Encryption
```bash
# Encrypt file with AES-256-CBC
openssl enc -aes-256-cbc -in plaintext.txt -out encrypted.bin

# Encrypt with password prompt
openssl enc -aes-256-cbc -in plaintext.txt -out encrypted.bin

# Decrypt file
openssl enc -aes-256-cbc -d -in encrypted.bin -out decrypted.txt

# Encrypt with key file
openssl enc -aes-256-cbc -in plaintext.txt -out encrypted.bin -kfile key.txt
```

### File Encryption
```bash
# Encrypt with base64 output
openssl enc -aes-256-cbc -in plaintext.txt -out encrypted.b64 -a

# Encrypt with salt
openssl enc -aes-256-cbc -in plaintext.txt -out encrypted.bin -salt

# Decrypt from base64
openssl enc -aes-256-cbc -d -in encrypted.b64 -a -out decrypted.txt
```

## Hashing and Digests

### Generate Hashes
```bash
# MD5 hash
openssl dgst -md5 file.txt

# SHA1 hash
openssl dgst -sha1 file.txt

# SHA256 hash
openssl dgst -sha256 file.txt

# SHA512 hash
openssl dgst -sha512 file.txt
```

### Hash Strings
```bash
# Hash string with MD5
echo -n "hello" | openssl dgst -md5

# Hash string with SHA256
echo -n "hello" | openssl dgst -sha256

# Hash with hex output
echo -n "hello" | openssl dgst -sha256 -hex
```

### HMAC
```bash
# HMAC with SHA256
echo -n "message" | openssl dgst -sha256 -hmac "secret_key"

# HMAC with key file
echo -n "message" | openssl dgst -sha256 -mac HMAC -macopt key:key.txt

# Multiple HMAC calculations
echo "message1" | openssl dgst -sha256 -hmac "key"
echo "message2" | openssl dgst -sha256 -hmac "key"
```

## SSL/TLS Operations

### Connect to Servers
```bash
# Connect to HTTPS server
openssl s_client -connect google.com:443

# Connect with SNI
openssl s_client -connect server.com:443 -servername server.com

# Connect and show certificate
openssl s_client -connect server.com:443 -showcerts

# Connect with specific cipher
openssl s_client -connect server.com:443 -cipher AES256-SHA256
```

### Test SSL Configuration
```bash
# Check SSL certificate
openssl s_client -connect domain.com:443 2>/dev/null | openssl x509 -noout -dates

# Check supported ciphers
openssl ciphers -v 'ALL:eNULL'

# Test certificate chain
openssl s_client -connect domain.com:443 -CAfile ca.crt
```

### Certificate Verification
```bash
# Verify certificate against CA
openssl verify -CAfile ca.crt certificate.crt

# Verify certificate chain
openssl verify -untrusted intermediate.crt certificate.crt

# Check OCSP
openssl ocsp -issuer ca.crt -certificate certificate.crt -url http://ocsp.example.com
```

## Key Operations

### RSA Key Operations
```bash
# Generate RSA key pair
openssl genrsa -out private.key 2048
openssl rsa -in private.key -pubout -out public.key

# Extract public key from private key
openssl rsa -in private.key -pubout -out public.key

# Encrypt with public key
openssl rsautl -encrypt -pubin -inkey public.key -in plaintext.txt -out encrypted.txt

# Decrypt with private key
openssl rsautl -decrypt -inkey private.key -in encrypted.txt -out decrypted.txt
```

### Key Conversion
```bash
# RSA private key to public key
openssl rsa -in private.key -pubout -out public.key

# Traditional to PKCS#8 format
openssl pkcs8 -topk8 -in traditional.key -out pkcs8.key

# Remove password from private key
openssl rsa -in encrypted.key -out decrypted.key

# Add password to private key
openssl rsa -in private.key -aes256 -out encrypted.key
```

## Data Signing and Verification

### Digital Signatures
```bash
# Create digital signature
openssl dgst -sha256 -sign private.key -out signature.bin data.txt

# Verify signature
openssl dgst -sha256 -verify public.key -signature signature.bin data.txt

# Sign with base64 output
openssl dgst -sha256 -sign private.key -out signature.b64 data.txt | base64
```

### Certificate Signing
```bash
# Sign certificate with CA
openssl x509 -req -in request.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out signed.crt -days 365

# Create CA-signed certificate
openssl ca -in request.csr -out signed.crt -cert ca.crt -keyfile ca.key
```

## Password Generation and Testing

### Password Generation
```bash
# Generate random password
openssl rand -base64 32

# Generate hex password
openssl rand -hex 16

# Generate alphanumeric password
openssl rand -base64 32 | tr -d "=+/" | cut -c1-25
```

### Password Hashing
```bash
# Generate password hash
openssl passwd -crypt password

# Generate SHA-512 password hash
openssl passwd -6 password

# Generate Apache password hash
openssl passwd -apr1 password
```

## Practical Examples

### Certificate Management
```bash
# Create self-signed certificate
openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes

# View certificate details
openssl x509 -in cert.pem -text -noout

# Check certificate expiration
openssl x509 -in cert.pem -noout -dates
```

### File Encryption
```bash
# Encrypt sensitive file
openssl enc -aes-256-cbc -salt -in sensitive.txt -out encrypted.enc

# Decrypt file
openssl enc -aes-256-cbc -d -in encrypted.enc -out decrypted.txt
```

### SSL/TLS Testing
```bash
# Test SSL certificate
openssl s_client -connect website.com:443 -showcerts

# Check SSL configuration
openssl s_client -connect website.com:443 -tls1_2

# Test cipher support
openssl ciphers -v 'HIGH:!aNULL:!MD5'
```

### Hash Verification
```bash
# Create checksum
openssl dgst -sha256 file.iso > checksum.txt

# Verify checksum
openssl dgst -sha256 -checksum checksum.txt file.iso
```

## Debugging and Troubleshooting

### SSL Certificate Issues
```bash
# Check certificate chain
openssl s_client -connect domain.com:443 -showcerts

# Verify certificate
openssl verify -verbose -CAfile ca.crt certificate.crt

# Check certificate revocation
openssl ocsp -issuer ca.crt -certificate certificate.crt -url http://ocsp.example.com
```

### Connection Testing
```bash
# Test HTTPS connection
openssl s_client -connect domain.com:443 -servername domain.com

# Test with specific protocol
openssl s_client -connect domain.com:443 -tls1_2

# Debug SSL handshake
openssl s_client -connect domain.com:443 -debug
```

## Tips
- Always use strong encryption algorithms (AES-256, SHA-256+)
- Protect private keys with strong passwords
- Regularly update OpenSSL to the latest version
- Use appropriate key sizes (2048+ for RSA, 256+ for ECC)
- Verify certificates before trusting them
- Use secure random number generation
- Store certificates and keys securely
- Document certificate expiration dates
- Test SSL/TLS configurations regularly
- Use appropriate cipher suites for your security requirements