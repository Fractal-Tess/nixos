# Masscan - High-Speed TCP Port Scanner

## Overview
Masscan is an asynchronous TCP port scanner designed for scanning large networks quickly:
- Can scan entire internet in under 5 minutes
- Similar interface to Nmap but much faster
- Asynchronous transmission design
- Supports arbitrary IP address ranges

## Basic Usage

### Quick Scanning
```bash
# Scan common ports on single host
masscan 192.168.1.1 -p80,443,22

# Scan port range on subnet
masscan 192.168.1.0/24 -p1-65535

# Scan single port across large range
masscan 0.0.0.0/0 -p80
```

### Rate Control
```bash
# Set scan rate (packets per second)
masscan 192.168.1.0/24 -p80 --rate=1000

# Maximum rate (may cause network issues)
masscan 192.168.1.0/24 -p80 --rate=1000000

# Slow scan to avoid detection
masscan 192.168.1.0/24 -p80 --rate=100
```

## Advanced Options

### Target Specification
```bash
# Multiple targets
masscan 192.168.1.1,192.168.1.100,10.0.0.1 -p80

# Range notation
masscan 192.168.1.1-192.168.1.100 -p80

# IP range file
echo "192.168.1.1
192.168.1.100
10.0.0.1" > targets.txt
masscan -iL targets.txt -p80
```

### Port Specification
```bash
# Port ranges
masscan 192.168.1.1 -p1-1000

# Multiple port ranges
masscan 192.168.1.1 -p1-100,800-900

# Port list file
echo "80
443
22
8080" > ports.txt
masscan 192.168.1.1 -pL ports.txt
```

### Output Options
```bash
# Save results to file
masscan 192.168.1.0/24 -p80 -o results.txt

# XML output
masscan 192.168.1.0/24 -p80 -oX results.xml

# JSON output
masscan 192.168.1.0/24 -p80 -oJ results.json

# Grepable output
masscan 192.168.1.0/24 -p80 -oG results.gnmap

# Verbose output
masscan 192.168.1.0/24 -p80 -v

# Quiet output
masscan 192.168.1.0/24 -p80 --quiet
```

### Network Configuration
```bash
# Use specific network interface
masscan 192.168.1.0/24 -p80 --interface eth0

# Set source IP address
masscan 192.168.1.0/24 -p80 --source-ip 192.168.1.10

# Set source port
masscan 192.168.1.0/24 -p80 --source-port 40000
```

## Scanning Techniques

### TCP SYN Scan (Default)
```bash
# Default SYN scan
masscan 192.168.1.1 -p80

# Custom TCP flags
masscan 192.168.1.1 -p80 --tcp-flags FIN,PSH,URG
```

### UDP Scanning
```bash
# UDP scan
masscan 192.168.1.1 -p53 --source-port 53

# Specific UDP payload
masscan 192.168.1.1 -p53 --payload-file dns.payload
```

### Banner Grabbing
```bash
# Grab banners after connection
masscan 192.168.1.1 -p80 --banners

# Grab banners with custom script
masscan 192.168.1.1 -p80 --banners --banner-script http-title
```

## Practical Examples

### Large Network Discovery
```bash
# Fast scan of entire class C network for web servers
masscan 192.168.0.0/16 -p80,443,8080,8443 --rate=10000 -o web_servers.txt
```

### Port Discovery
```bash
# Find open ports on target network
masscan 10.0.0.0/24 -p1-65535 --rate=1000 -o open_ports.txt
```

### Internet-Scale Scanning
```bash
# Scan internet for specific service
masscan 0.0.0.0/0 -p22 --rate=1000000 -o ssh_servers.txt

# Scan specific country ranges
masscan 1.0.0.0/8 -p80 --rate=500000 -o cn_webservers.txt
```

### Combined with Other Tools
```bash
# Scan and immediately test with nmap
masscan 192.168.1.0/24 -p80 --rate=1000 -o targets.txt
nmap -iL targets.txt -sV -p80

# Scan and curl for headers
masscan 192.168.1.0/24 -p80 --rate=1000 --banners | grep "open" | awk '{print $4}' | xargs -I{} curl -I http://{}
```

## Performance Optimization

### Rate Tuning
```bash
# Conservative rate for stable networks
masscan 192.168.1.0/24 -p80 --rate=1000

# Aggressive rate for fast networks
masscan 192.168.1.0/24 -p80 --rate=100000

# Test maximum rate
masscan 192.168.1.1 -p80 --rate=10000000 --test
```

### Resource Management
```bash
# Limit memory usage
masscan 192.168.1.0/24 -p80 --shard-rate=100

# Split scan across multiple machines
masscan 192.168.1.0/24 -p80 --shard 1/4
masscan 192.168.1.0/24 -p80 --shard 2/4
masscan 192.168.1.0/24 -p80 --shard 3/4
masscan 192.168.1.0/24 -p80 --shard 4/4
```

## Tips
- Use appropriate rates to avoid network congestion
- Combine with Nmap for detailed service enumeration
- Use source port 53 for DNS-like traffic
- Save results in multiple formats for analysis
- Be aware of ISP and network policies
- Test on small ranges before large-scale scans
- Use `--test` option to verify network capability