# Socat - Multipurpose Relay

## Overview
Socat (SOcket CAT) is a powerful relay for bidirectional data transfer between:
- Network sockets
- Files
- Pipes
- Devices
- SSL/TLS connections
- Serial ports

## Basic Usage

### Simple Connections
```bash
# Connect to TCP port
socat - TCP:target.com:80

# Connect to UDP port
socat - UDP:target.com:53

# Connect with verbose output
socat -v TCP:target.com:80

# Connect with timeout
socat -T 10 TCP:target.com:80
```

### Listener Mode
```bash
# Listen on TCP port
socat TCP-LISTEN:8080,fork,reuseaddr -

# Listen on UDP port
socat UDP-LISTEN:8080,fork,reuseaddr -

# Listen with backlog
socat TCP-LISTEN:8080,fork,backlog=128 -
```

## Port Forwarding

### TCP Forwarding
```bash
# Forward local port to remote port
socat TCP-LISTEN:8080,fork,reuseaddr TCP:target.com:80

# Forward with source address
socat TCP-LISTEN:8080,fork,reuseaddr,bind=192.168.1.100 TCP:target.com:80

# Forward to multiple targets
socat TCP-LISTEN:8080,fork,reuseaddr TCP:target1.com:80|TCP:target2.com:80
```

### Bidirectional Forwarding
```bash
# Bridge two ports
socat TCP-LISTEN:8080,fork,reuseaddr TCP-LISTEN:8081,fork,reuseaddr

# Bridge TCP and UDP
socat TCP-LISTEN:8080,fork,reuseaddr UDP:target.com:53
```

## File Operations

### File Sockets
```bash
# Read from file
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:input.txt

# Write to file
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:output.txt,creat,append

# Bidirectional file access
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:data.txt,rdwr
```

### Pipe Operations
```bash
# Pipe to command
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:cat

# Pipe to custom script
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:./script.sh

# System command execution
socat TCP-LISTEN:8080,fork,reuseaddr SYSTEM:"echo 'Hello World'"
```

## SSL/TLS Support

### SSL Client
```bash
# Connect to SSL server
socat - SSL:target.com:443,verify=0

# Connect with client certificate
socat - SSL:target.com:443,cert=client.pem,key=client.key,verify=0

# Connect with CA verification
socat - SSL:target.com:443,cafile=ca.pem
```

### SSL Server
```bash
# SSL listener
socat OPENSSL-LISTEN:8443,fork,reuseaddr,cert=server.pem,key=server.key,verify=0 -

# SSL listener with client auth
socat OPENSSL-LISTEN:8443,fork,reuseaddr,cert=server.pem,key=server.key,cafile=ca.pem,verify=1 -
```

## Serial Port Communication

### Serial Connections
```bash
# Connect to serial port
socat TCP-LISTEN:8080,fork,reuseaddr FILE:/dev/ttyS0,b115200,raw,echo=0

# Serial port settings
socat TCP-LISTEN:8080,fork,reuseaddr FILE:/dev/ttyUSB0,b9600,cs8,cstopb,parenb=0,raw,echo=0
```

### Virtual Serial Ports
```bash
# Create PTY pair
socat PTY,link=/tmp/ttyV0,raw,echo=0 PTY,link=/tmp/ttyV1,raw,echo=0

# TCP to serial bridge
socat TCP-LISTEN:8080,fork,reuseaddr FILE:/tmp/ttyV0,raw,echo=0
```

## Proxy Support

### HTTP Proxy
```bash
# Connect through HTTP proxy
socat - PROXY:proxy.com:target.com:80,proxyport=8080

# Connect with proxy authentication
socat - PROXY:proxy.com:target.com:80,proxyport=8080,proxyauth=user:pass
```

### SOCKS Proxy
```bash
# Connect through SOCKS4 proxy
socat - SOCKS4:proxy.com:target.com:80,socksport=1080

# Connect through SOCKS5 proxy
socat - SOCKS5:proxy.com:target.com:80,socksport=1080
```

## Network Testing

### Port Scanner
```bash
# Check if port is open
socat /dev/null TCP:target.com:80

# Scan port range
for port in {1..1000}; do
    socat /dev/null TCP:target.com:$port 2>/dev/null && echo "Port $port open"
done
```

### Bandwidth Testing
```bash
# TCP bandwidth test
socat -u /dev/zero TCP:target.com:8080

# UDP bandwidth test
socat -u /dev/zero UDP:target.com:8080

# Measure receive speed
socat -u TCP-LISTEN:8080,reuseaddr /dev/null
```

### Network Latency Testing
```bash
# Measure round-trip time
socat -T 1 - TCP:target.com:80 && echo "Connection successful"
```

## Advanced Features

### Data Processing
```bash
# Convert line endings
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:'sed "s/\r\n/\n/g"'

# Add timestamps
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:'sed "s/^/$(date): /"'

# Filter content
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:'grep "pattern"'
```

### Protocol Translation
```bash
# HTTP to TCP proxy
socat TCP-LISTEN:8080,fork,reuseaddr TCP:target.com:80

# UDP to TCP bridge
socat UDP-LISTEN:8080,fork,reuseaddr TCP:target.com:80

# IPv4 to IPv6 bridge
socat TCP4-LISTEN:8080,fork,reuseaddr TCP6:[::1]:8080
```

### Address Types
```bash
# Unix domain socket
socat TCP-LISTEN:8080,fork,reuseaddr UNIX:/tmp/socket

# IPv6 connection
socat TCP6:[::1]:8080

# Specific interface binding
socat TCP-LISTEN:8080,fork,reuseaddr,bind=192.168.1.100 TCP:target.com:80
```

## Security Features

### Access Control
```bash
# Allow specific clients
socat TCP-LISTEN:8080,fork,reuseaddr,range=192.168.1.0/24 TCP:target.com:80

# Deny specific clients
socat TCP-LISTEN:8080,fork,reuseaddr,range=!192.168.1.100 TCP:target.com:80
```

### Process Isolation
```bash
# Run as specific user
socat TCP-LISTEN:8080,fork,reuseaddr,su=nobody TCP:target.com:80

# Change root directory
socat TCP-LISTEN:8080,fork,reuseaddr,chroot=/var/empty TCP:target.com:80
```

## Practical Examples

### Simple Web Server
```bash
# Basic HTTP server
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:'echo -e "HTTP/1.1 200 OK\r\n\r\nHello World"'
```

### File Transfer Server
```bash
# Upload server
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:uploads.bin,creat,append

# Download server
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:file.txt
```

### Reverse Shell
```bash
# Reverse shell
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:/bin/bash

# Encrypted reverse shell
socat OPENSSL-LISTEN:8443,fork,reuseaddr,cert=server.pem,key=server.key EXEC:/bin/bash
```

### Network Tunnel
```bash
# TCP tunnel
socat TCP-LISTEN:8080,fork,reuseaddr TCP:target.com:80

# Encrypted tunnel
socat OPENSSL-LISTEN:8443,fork,reuseaddr,cert=server.pem,key=server.key TCP:target.com:80
```

### Data Logger
```bash
# Log all connections
socat TCP-LISTEN:8080,fork,reuseaddr OPEN:connection.log,creat,append

# Log with timestamps
socat TCP-LISTEN:8080,fork,reuseaddr EXEC:'date >> connection.log; cat'
```

## Error Handling

### Retry Logic
```bash
# Retry on failure
socat TCP-LISTEN:8080,fork,reuseaddr,retry=30,interval=5 TCP:target.com:80

# Continue on errors
socat TCP-LISTEN:8080,fork,reuseaddr,ignoreeof TCP:target.com:80
```

### Timeout Settings
```bash
# Connection timeout
socat TCP-LISTEN:8080,fork,reuseaddr,connect-timeout=10 TCP:target.com:80

# Inactivity timeout
socat TCP-LISTEN:8080,fork,reuseaddr,idle-timeout=300 TCP:target.com:80
```

## Tips
- Use `fork` for handling multiple concurrent connections
- Use `reuseaddr` to allow immediate port reuse
- Combine with `exec` for custom protocol handling
- Use SSL/TLS for secure connections
- Monitor with `-v -v` for detailed debugging
- Consider security implications when executing commands
- Test with simple connections before complex setups
- Use appropriate timeouts to prevent hanging connections