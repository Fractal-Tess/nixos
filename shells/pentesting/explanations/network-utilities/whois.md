# WHOIS - Domain and Network Information Lookup

## Overview
WHOIS is a query and response protocol for:
- Domain name registration information
- IP address ownership details
- Network block information
- Contact information
- Registration and expiration dates

## Basic Usage

### Domain WHOIS
```bash
# Basic domain lookup
whois example.com

# WHOIS with specific server
whois -h whois.example.com example.com

# WHOIS for different TLDs
whois example.org
whois example.net
whois example.edu
```

### IP Address WHOIS
```bash
# IP address lookup
whois 8.8.8.8

# CIDR block lookup
whois 192.168.1.0/24

# IPv6 address lookup
whois 2001:4860:4860::8888
```

## Query Options

### WHOIS Servers
```bash
# Use specific WHOIS server
whois -h whois.verisign-grs.com example.com

# Use different WHOIS port
whois -p 43 example.com

# Query regional registry
whois -h whois.iana.org example.com

# Query ARIN (American Registry for Internet Numbers)
whois -h whois.arin.net 8.8.8.8
```

### Output Control
```bash
# Short output
whois -H example.com

# Suppress legal disclaimers
whois -D example.com

# Raw WHOIS output
whois --raw example.com

# Query multiple domains
whois example.com example.net example.org
```

## Domain Information Analysis

### Registration Details
```bash
# Get domain registration info
whois example.com | grep -E "(Registrar|Registration|Created|Expires)"

# Get name servers
whois example.com | grep -A 5 "Name Server"

# Get registrar information
whois example.com | grep -A 10 "Registrar"

# Get status information
whois example.com | grep -E "(Status|Domain Status)"
```

### Contact Information
```bash
# Extract admin contact
whois example.com | grep -A 10 "Admin"

# Extract technical contact
whois example.com | grep -A 10 "Tech"

# Extract registrant contact
whois example.com | grep -A 10 "Registrant"
```

## IP Address Intelligence

### IP Geolocation
```bash
# Basic IP information
whois 8.8.8.8

# Network range information
whois 8.8.8.8 | grep -E "(NetRange|CIDR|Organization)"

# ISP information
whois 8.8.8.8 | grep -E "(Organization|ISP|Provider)"

# Abuse contact information
whois 8.8.8.8 | grep -i abuse
```

### Network Analysis
```bash
# Find network owner
whois 192.168.1.1 | grep "Organization"

# Find net ranges
whois 192.168.1.1 | grep -E "(NetRange|inetnum)"

# Find country information
whois 192.168.1.1 | grep -i "Country"

# Find contact information
whois 192.168.1.1 | grep -E "(OrgName|OrgTech|OrgAbuse)"
```

## Regional Registries

### ARIN (Americas)
```bash
# Query ARIN database
whois -h whois.arin.net 192.168.1.1

# Query ARIN for ASN
whois -h whois.arin.net AS15169

# ARIN specific format
whois -h whois.arin.net "n 192.168.1.1"
```

### RIPE (Europe)
```bash
# Query RIPE database
whois -h whois.ripe.net 192.168.1.1

# RIPE specific queries
whois -h whois.ripe.net "192.168.1.1"

# Query RIPE for organization
whois -h whois.ripe.net "ORG-GOGL1-RIPE"
```

### APNIC (Asia-Pacific)
```bash
# Query APNIC database
whois -h whois.apnic.net 192.168.1.1

# APNIC specific format
whois -h whois.apnic.net "192.168.1.1"

# Query APNIC for resources
whois -h whois.apnic.net "202.12.27.33"
```

## Security Research

### Threat Intelligence
```bash
# Check IP reputation
whois suspicious_ip

# Find ISP for abuse reporting
whois malicious_ip | grep -i abuse

# Check domain ownership
whois suspicious_domain.com

# Find hosting provider
whois ip_address | grep -i hosting
```

### Network Mapping
```bash
# Discover IP ranges
whois main_ip | grep "NetRange"

# Find related networks
whois organization_name

# Find ASN information
whois AS_NUMBER

# Map network ownership
for ip in $(cat ip_list.txt); do
    whois $ip | grep "Organization"
done
```

## Practical Examples

### Domain Reconnaissance Script
```bash
#!/bin/bash
# Domain reconnaissance tool

domain="$1"

if [ -z "$domain" ]; then
    echo "Usage: $0 <domain>"
    exit 1
fi

echo "=== Domain Information for $domain ==="

# Basic domain info
echo "Registration Information:"
whois "$domain" | grep -E "(Registrar|Created|Expires|Updated)"

echo ""
echo "Name Servers:"
whois "$domain" | grep "Name Server" | sort -u

echo ""
echo "Status:"
whois "$domain" | grep "Domain Status"

echo ""
echo "Registrar:"
whois "$domain" | grep -A 5 "Registrar"

echo ""
echo "Contact Information:"
whois "$domain" | grep -E "(Admin|Tech|Registrant)" | head -10
```

### IP Intelligence Script
```bash
#!/bin/bash
# IP intelligence gathering

ip="$1"

if [ -z "$ip" ]; then
    echo "Usage: $0 <ip_address>"
    exit 1
fi

echo "=== IP Information for $ip ==="

# Basic IP information
echo "Network Information:"
whois "$ip" | grep -E "(NetRange|CIDR|Organization|Country)"

echo ""
echo "ISP Information:"
whois "$ip" | grep -E "(ISP|Provider|Service Provider)"

echo ""
echo "Contact Information:"
whois "$ip" | grep -E "(OrgTech|OrgAbuse|Abuse)"

echo ""
echo "Geographic Information:"
whois "$ip" | grep -E "(City|State|Country)"
```

### Bulk WHOIS Lookup
```bash
#!/bin/bash
# Bulk WHOIS lookup

input_file="$1"

if [ -z "$input_file" ]; then
    echo "Usage: $0 <input_file>"
    echo "File format: one domain/IP per line"
    exit 1
fi

output_dir="whois_results"
mkdir -p "$output_dir"

while read target; do
    if [ ! -z "$target" ]; then
        echo "Processing: $target"
        whois "$target" > "$output_dir/${target}_whois.txt"
        sleep 1  # Be respectful to WHOIS servers
    fi
done < "$input_file"

echo "Results saved to $output_dir/"
```

### Domain Expiration Monitor
```bash
#!/bin/bash
# Domain expiration monitoring

domains_file="$1"

if [ -z "$domains_file" ]; then
    echo "Usage: $0 <domains_file>"
    exit 1
fi

while read domain; do
    if [ ! -z "$domain" ]; then
        echo "Checking: $domain"
        expiry_date=$(whois "$domain" | grep -i "expiration date" | head -1 | awk '{print $NF}')

        if [ ! -z "$expiry_date" ]; then
            # Convert to comparable format (basic implementation)
            echo "$domain expires on: $expiry_date"

            # Alert if expiring soon (simple check)
            if [[ "$expiry_date" == *"2024"* ]]; then
                echo "  WARNING: Expiring in 2024!"
            fi
        else
            echo "  Could not determine expiry date"
        fi
        echo ""
    fi
done < "$domains_file"
```

## Automation and Integration

### WHOIS with Other Tools
```bash
# Combine with dig
domain="example.com"
echo "DNS Records:"
dig "$domain" ANY
echo ""
echo "WHOIS Information:"
whois "$domain"

# Combine with nmap
ip="192.168.1.1"
echo "Network Scan:"
nmap -sn "$ip"
echo ""
echo "WHOIS Information:"
whois "$ip"
```

### WHOIS Database Building
```bash
#!/bin/bash
# Build local WHOIS database

domains=("google.com" "facebook.com" "twitter.com" "github.com")

for domain in "${domains[@]}"; do
    echo "Caching WHOIS for $domain"
    whois "$domain" > "whois_cache/${domain}.txt"
    sleep 2
done

echo "WHOIS cache built"
```

## Troubleshooting

### Common Issues
```bash
# Rate limiting
# WHOIS servers may rate limit queries
# Add delays between queries
sleep 1

# Server not responding
# Try different WHOIS servers
whois -h whois.verisign-grs.com example.com
whois -h whois.crsnic.net example.com

# Incomplete information
# Try regional registries
whois -h whois.arin.net 8.8.8.8
whois -h whois.ripe.net 8.8.8.8
```

### WHOIS Server Selection
```bash
# Automatic server selection (default)
whois example.com

# Manual server selection
whois -h whois.verisign-grs.com example.com

# Regional IP queries
whois -h whois.arin.net 192.168.1.0
whois -h whois.ripe.net 192.168.1.0
whois -h whois.apnic.net 192.168.1.0
```

## Tips
- Use appropriate WHOIS servers for different regions
- Add delays between bulk queries to avoid rate limiting
- Parse WHOIS output carefully as formats vary
- Consider privacy settings that may limit information
- Use WHOIS for initial reconnaissance
- Combine with other tools for comprehensive intelligence
- Be respectful of WHOIS server resources
- Document findings for future reference
- Consider legal implications of WHOIS data collection
- Use WHOIS responsibly for legitimate security research