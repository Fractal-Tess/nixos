# Hping - Network Packet Crafting Tool

## Overview
Hping is a command-line packet crafting and network scanning tool for:
- Custom packet creation
- Firewall testing
- Network auditing
- Port scanning
- OS fingerprinting
- TCP/IP stack testing

## Basic Usage

### Simple Packet Sending
```bash
# Send TCP packets to port 80
hping3 target.com

# Send packets to specific port
hping3 -p 80 target.com

# Send UDP packets
hping3 --udp target.com

# Send ICMP packets
hping3 --icmp target.com
```

### Basic Options
```bash
# Set destination port
hping3 -p 80 target.com

# Set source port
hping3 -s 40000 target.com

# Set count of packets
hping3 -c 10 target.com

# Set interval between packets
hping3 -i 1 target.com  # 1 second
hping3 -i u1000 target.com  # 1000 microseconds
```

## TCP Packet Crafting

### TCP Options
```bash
# SYN packet
hping3 -S target.com

# ACK packet
hping3 -A target.com

# FIN packet
hping3 -F target.com

# RST packet
hping3 -R target.com

# XMAS scan (all flags set)
hping3 -X target.com

# Custom flags
hping3 --setseq 1000 --setack 2000 target.com
```

### Port Scanning
```bash
# SYN scan
hping3 -S -p 80 -c 1 target.com

# SYN scan with source port
hping3 -S -p 80 -s 40000 target.com

# Scan port range (script)
for port in {1..1000}; do
    hping3 -S -p $port -c 1 target.com
done

# ACK scan (for firewall rules)
hping3 -A -p 80 target.com
```

### Connection Testing
```bash
# Test if port is open
hping3 -S -p 80 -c 1 target.com

# Test with timeout
hping3 -S -p 80 -c 1 --timeout 5 target.com

# Continuous ping
hping3 -S -p 80 -d 1024 target.com
```

## UDP and ICMP

### UDP Packets
```bash
# Send UDP packet
hping3 --udp -p 53 target.com

# UDP scan
hping3 --udp -p 161 -c 1 target.com

# UDP with data
hping3 --udp -p 5000 -d 100 target.com

# DNS query simulation
hping3 --udp -p 53 -d 100 target.com
```

### ICMP Packets
```bash
# ICMP echo request
hping3 --icmp target.com

# ICMP timestamp request
hping3 --icmp -C 13 target.com

# ICMP address mask request
hping3 --icmp -C 17 target.com

# Custom ICMP type
hping3 --icmp --icmp-type 8 target.com
```

## Advanced Packet Crafting

### Custom Headers
```bash
# Set TTL
hping3 --ttl 64 target.com

# Set IP identification
hping3 --id 12345 target.com

# Set TCP sequence number
hping3 --setseq 1000 target.com

# Set TCP acknowledgment number
hping3 --setack 2000 target.com

# Set TCP window size
hping3 --win 64240 target.com
```

### Data and Payload
```bash
# Send custom data
hping3 -d 100 -E "GET / HTTP/1.0\r\n\r\n" target.com

# Send file content
hping3 -d $(wc -c < payload.txt) -E payload.txt target.com

# Random data
hping3 -d 100 --file /dev/urandom target.com

# Hex data
hping3 --file hex_data.txt target.com
```

### IP Options
```bash
# Set source IP
hping3 -a 192.168.1.100 target.com

# IP fragmentation
hping3 --frag -d 1500 target.com

# Set TOS (Type of Service)
hping3 --tos 0x10 target.com

# Set DF (Don't Fragment) flag
hping3 --rf target.com
```

## Traceroute and Path Discovery

### Traceroute
```bash
# TCP traceroute to port 80
hping3 -S -p 80 --traceroute target.com

# UDP traceroute
hping3 --udp -p 53 --traceroute target.com

# ICMP traceroute
hping3 --icmp --traceroute target.com

# Set max TTL
hping3 -S -p 80 --ttl 30 target.com
```

### Path MTU Discovery
```bash
# Find path MTU
hping3 -d 1500 -F target.com

# Fragmentation test
hping3 --frag --mtu 1500 target.com
```

## Flood and Stress Testing

### Packet Flooding
```bash
# SYN flood
hping3 -S -p 80 --flood target.com

# UDP flood
hping3 --udp -p 5000 --flood target.com

# ICMP flood
hping3 --icmp --flood target.com

# Custom flood rate
hping3 -S -p 80 --flood --rand-source target.com
```

### Rate Limiting
```bash
# Send packets at specific rate
hping3 -S -p 80 -i u1000 target.com

# Send packets with delay
hping3 -S -p 80 --fast target.com
hping3 -S -p 80 --faster target.com
```

## Network Testing and Auditing

### Firewall Testing
```bash
# Test firewall rules
hping3 -S -p 22 target.com
hping3 -A -p 22 target.com
hping3 -F -p 22 target.com

# Test NAT rules
hping3 -S -p 80 --rand-source target.com

# Test stateful firewall
hping3 -S -p 80 target.com
hping3 -A -p 80 target.com
```

### Bandwidth Testing
```bash
# Test bandwidth
hping3 -S -p 80 -d 1024 --fast target.com

# Test packet loss
hping3 -S -p 80 -c 1000 target.com

# Test latency
hping3 -S -p 80 -c 100 -i u1000 target.com
```

## OS Fingerprinting

### TCP Stack Analysis
```bash
# TCP window size analysis
hping3 -S -p 80 -c 1 target.com

# TCP options analysis
hping3 -S -p 80 --tcp-options target.com

# TTL analysis
hping3 -S -p 80 --ttl 64 target.com
```

### Passive Fingerprinting
```bash
# Analyze responses
hping3 -S -p 80 -c 1 target.com

# Check TCP flags in response
hping3 -S -p 80 -c 1 -V target.com
```

## Practical Examples

### Port Scanning Script
```bash
#!/bin/bash
# Hping port scanner

target=$1
start_port=$2
end_port=$3

if [ -z "$target" ]; then
    echo "Usage: $0 <target> [start_port] [end_port]"
    exit 1
fi

start_port=${start_port:-1}
end_port=${end_port:-1000}

echo "Scanning $target ports $start_port-$end_port..."

for port in $(seq $start_port $end_port); do
    result=$(hping3 -S -p $port -c 1 $target 2>/dev/null | grep "flags=SA")
    if [ ! -z "$result" ]; then
        echo "Port $port is open"
    fi
done
```

### Network Stress Testing
```bash
#!/bin/bash
# Network stress test

target=$1
duration=$2

if [ -z "$target" ]; then
    echo "Usage: $0 <target> [duration]"
    exit 1
fi

duration=${duration:-60}

echo "Stress testing $target for $duration seconds..."

# Run in background and kill after duration
hping3 -S -p 80 --flood $target &
HPID=$!

sleep $duration
kill $HPID

echo "Stress test completed"
```

### Connectivity Testing
```bash
#!/bin/bash
# Connectivity test for multiple hosts

hosts=("google.com" "github.com" "stackoverflow.com")
ports=(80 443 22)

for host in "${hosts[@]}"; do
    echo "Testing $host..."

    for port in "${ports[@]}"; do
        result=$(hping3 -S -p $port -c 1 $host 2>/dev/null | grep "flags=SA")
        if [ ! -z "$result" ]; then
            echo "  Port $port: Open"
        else
            echo "  Port $port: Closed/Filtered"
        fi
    done
done
```

## Advanced Techniques

### Packet Assembly
```bash
# Custom TCP packet with specific options
hping3 -S -p 80 --setseq 1000 --setack 1001 --win 64240 target.com

# Packet with IP options
hping3 -S -p 80 --ip-options "RR" target.com

# Fragmented packet
hping3 --frag -d 1500 target.com
```

### Stealth Scanning
```bash
# Slow scan to avoid detection
hping3 -S -p 80 -i 5 target.com

# Random source addresses
hping3 -S -p 80 --rand-source target.com

# Decoy scanning
for i in {1..5}; do
    hping3 -S -p 80 -a "192.168.1.$i" target.com &
done
```

## Output and Analysis

### Verbose Output
```bash
# Show detailed information
hping3 -V target.com

# Show packet details
hping3 -S -p 80 -c 1 -V target.com

# Save output to file
hping3 -S -p 80 -c 100 target.com > hping_results.txt
```

### Packet Analysis
```bash
# Capture responses with tcpdump
tcpdump -i eth0 -n host target.com &

# Send packets and analyze
hping3 -S -p 80 target.com
```

## Tips
- Use appropriate packet types for different tests
- Be careful with flood attacks - they can cause network disruption
- Combine with tcpdump for detailed packet analysis
- Use random source IPs for stealth scanning
- Test in lab environments before production use
- Be aware of legal implications of network testing
- Use rate limiting to avoid detection
- Consider network impact when stress testing
- Use hping for firewall rule validation
- Document network behavior patterns for comparison