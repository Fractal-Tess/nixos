# Binutils-Unwrapped - Binary Utilities

## Overview
Binutils-unwrapped provides access to GNU binary utilities for:
- Object file manipulation
- Binary analysis
- Assembly/disassembly
- Linking and loading
- Symbol table operations
- Debugging information extraction

## Key Utilities

### Core Tools
```bash
# objdump - Display information from object files
objdump -f program.o          # File header information
objdump -h program.o          # Section headers
objdump -r program.o          # Relocation information
objdump -t program.o          # Symbol table
objdump -d program.o          # Disassemble

# nm - List symbols from object files
nm program.o                  # List symbols
nm -D program                 # Dynamic symbols
nm -g program                 # Only external symbols

# size - List section sizes
size program.o                # Show section sizes
size -A program.o             # Show all section info

# strings - Extract printable strings
strings program.o             # Extract strings
strings -n 8 program.o        # Minimum string length 8
```

## Object File Analysis

### Display Object File Information
```bash
# Show file header
objdump -f program.o

# Show section headers
objdump -h program.o

# Show program headers (for executables)
objdump -l program

# Show all headers
objdump -x program.o

# Show specific section
objdump -j .text -d program.o
```

### Symbol Analysis
```bash
# List all symbols
nm program.o

# Show symbol types
nm -t d program.o             # Decimal format
nm -t x program.o             # Hexadecimal format

# Show only undefined symbols
nm -u program.o

# Show only defined symbols
nm -D program.o               # Dynamic symbols only

# Sort symbols by size
nm --size-sort program.o
```

### Disassembly
```bash
# Disassemble sections
objdump -d program.o          # Disassemble .text section
objdump -D program.o          # Disassemble all sections

# Show source intermix (with debugging info)
objdump -S program.o

# Show with Intel syntax
objdump -M intel -d program.o

# Show with AT&T syntax (default)
objdump -M att -d program.o

# Show specific function
objdump -d program.o | grep "function_name:" -A 20
```

## Executable Analysis

### ELF Executable Analysis
```bash
# Show ELF header
readelf -h program

# Show program headers
readelf -l program

# Show section headers
readelf -S program

# Show symbol table
readelf -s program

# Show dynamic section
readelf -d program

# Show dependency information
readelf -d program | grep NEEDED
```

### Shared Library Analysis
```bash
# List shared library dependencies
ldd program

# Show dynamic symbols
nm -D program

# Show relocations
objdump -R program

# Show PLT and GOT
objdump -j .plt -d program
objdump -j .got -d program
```

## Strings and Data Extraction

### String Extraction
```bash
# Extract all strings
strings program.o

# Extract specific length strings
strings -n 10 program.o        # Minimum 10 characters

# Extract only printable ASCII
strings -a program.o

# Extract from specific section
strings -t d -j .data program.o

# Show strings with file offset
strings -t x program.o
```

### Data Pattern Search
```bash
# Search for specific patterns
strings program.o | grep "password"

# Search for URLs
strings program.o | grep -E "http://|https://"

# Search for file paths
strings program.o | grep -E "^/|^\\"

# Search for error messages
strings program.o | grep -i "error\|fail"
```

## Linking and Relocation

### Relocation Information
```bash
# Show relocation entries
objdump -r program.o

# Show dynamic relocations
objdump -R program

# Show specific relocation types
readelf -r program.o

# Show symbol table entries for relocations
readelf -s program.o
```

### Linking Analysis
```bash
# Show undefined symbols
nm -u program.o

# Show what symbols are needed
objdump -T program

# Show library dependencies
ldd program

# Show dynamic linking information
readelf -l program | grep INTERP
```

## Debugging Information

### Debug Symbols
```bash
# Show debug information
objdump -g program.o

# Show source line information
objdump -l -d program.o

# Show debugging sections
readelf -S program.o | grep debug

# Extract source file names
strings program.o | grep "\.c$" | sort -u
```

### DWARF Debug Information
```bash
# Show DWARF info
objdump --dwarf=info program.o

# Show DWARF abbreviations
objdump --dwarf=abbrev program.o

# Show DWARF line information
objdump --dwarf=decodedline program.o

# Show DWARF aranges
objdump --dwarf=aranges program.o
```

## Binary Modification

### Patching Binaries
```bash
# Extract specific bytes
dd if=program bs=1 skip=0x100 count=4 | hexdump -C

# Modify bytes (requires careful use)
# This is dangerous and requires exact knowledge
printf '\x90\x90\x90\x90' | dd of=program bs=1 seek=0x100 count=4 conv=notrunc
```

### Object File Manipulation
```bash
# Copy specific sections
objcopy --only-section=.text program.o text_only.o

# Remove debug information
objcopy --strip-debug program.o stripped.o

# Add/remove sections
objcopy --add-section .data=data.dat program.o new_program.o

# Change section flags
objcopy --set-section-flags .text=alloc,code,load program.o
```

## Architecture Analysis

### Cross-Architecture Support
```bash
# Disassemble for different architectures
objdump -b i386 -d program.o
objdump -b i386:x86-64 -d program.o
objdump -b arm -d program.o

# Show architecture-specific info
objdump -f program.o          # File format and architecture
readelf -h program            # Machine architecture
```

### Instruction Set Analysis
```bash
# Show instruction encoding
objdump -d program.o | head -20

# Show disassembly with bytes
objdump -d -S program.o

# Show different syntaxes
objdump -M intel -d program.o    # Intel syntax
objdump -M att -d program.o      # AT&T syntax
```

## Practical Examples

### Malware Analysis
```bash
# Basic malware analysis
echo "=== File Information ==="
file malware.exe

echo "=== Strings Analysis ==="
strings malware.exe | head -20

echo "=== Import Analysis ==="
objdump -p malware.exe | grep DLL

echo "=== Entry Point ==="
objdump -f malware.exe

echo "=== Disassembly ==="
objdump -d malware.exe | head -50
```

### Security Research
```bash
# Find interesting strings
strings program | grep -E "(password|secret|key|token)"

# Find network-related strings
strings program | grep -E "(http|ftp|tcp|udp)"

# Find file operations
strings program | grep -E "(open|read|write|create)"

# Find potential vulnerabilities
objdump -d program.o | grep -E "(strcpy|strcat|sprintf|gets)"
```

### Binary Comparison
```bash
# Compare two binaries
echo "=== Binary 1 ==="
strings binary1 | sort > strings1.txt

echo "=== Binary 2 ==="
strings binary2 | sort > strings2.txt

echo "=== Differences ==="
diff strings1.txt strings2.txt

# Compare disassembly
objdump -d binary1 > disasm1.txt
objdump -d binary2 > disasm2.txt
diff disasm1.txt disasm2.txt
```

## Automation Scripts

### Binary Analysis Script
```bash
#!/bin/bash
# Comprehensive binary analysis

analyze_binary() {
    local binary="$1"

    echo "=== Analyzing $binary ==="

    # Basic information
    echo "File Information:"
    file "$binary"
    echo ""

    # Architecture information
    echo "Architecture:"
    readelf -h "$binary" | grep Machine
    echo ""

    # Entry point
    echo "Entry Point:"
    objdump -f "$binary"
    echo ""

    # Sections
    echo "Sections:"
    objdump -h "$binary"
    echo ""

    # Dependencies
    echo "Dependencies:"
    ldd "$binary"
    echo ""

    # Interesting strings
    echo "Interesting Strings:"
    strings "$binary" | grep -E "(password|secret|http|ftp)" | head -10
    echo ""

    # Entry point disassembly
    echo "Entry Point Disassembly:"
    entry_point=$(readelf -h "$binary" | grep Entry | awk '{print $3}')
    objdump -d "$binary" | grep -A 20 "$entry_point"
}

# Analyze provided binaries
for binary in "$@"; do
    analyze_binary "$binary"
    echo "========================================"
done
```

### String Extraction Script
```bash
#!/bin/bash
# Extract and categorize strings

categorize_strings() {
    local binary="$1"
    local output_dir="${binary}_strings"

    mkdir -p "$output_dir"

    # Extract all strings
    strings "$binary" > "$output_dir/all_strings.txt"

    # Categorize strings
    strings "$binary" | grep -E "^/" > "$output_dir/paths.txt"
    strings "$binary" | grep -E "(http|ftp)" > "$output_dir/urls.txt"
    strings "$binary" | grep -E "(password|secret|key)" > "$output_dir/sensitive.txt"
    strings "$binary" | grep -E "\.(dll|exe|so)" > "$output_dir/libraries.txt"

    echo "String categorization complete for $binary"
    echo "Results in $output_dir/"
}

# Process binaries
for binary in "$@"; do
    categorize_strings "$binary"
done
```

## Integration with Other Tools

### Combine with GDB
```bash
# Get function addresses for GDB
nm program.o | grep "function_name"

# Get section information for debugging
readelf -S program.o

# Disassemble specific function for analysis
objdump -d program.o | grep "function_name:" -A 20
```

### Combine with objcopy
```bash
# Extract specific sections
objcopy --only-section=.data program.o data.bin
xxd data.bin | head -10

# Strip debugging information
objcopy --strip-debug program.o stripped.o
size program.o stripped.o
```

## Tips
- Use `objdump` for detailed disassembly and analysis
- Use `nm` for quick symbol examination
- Use `strings` for quick reconnaissance
- Use `readelf` for ELF-specific information
- Use `objcopy` for binary modification
- Combine tools for comprehensive analysis
- Be careful when modifying binaries directly
- Use appropriate syntax for your target architecture
- Consider security implications when analyzing unknown binaries
- Document your analysis process and findings