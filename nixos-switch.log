warning: Git tree '/home/fractal-tess/nixos' is dirty
building the system configuration...
warning: Git tree '/home/fractal-tess/nixos' is dirty
error:
       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1529:14:
         1528|         zipAttrsWith (
         1529|           n: values:
             |              ^
         1530|           let

       … while calling the 'head' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1534:13:
         1533|           if length values == 1 || pred here (elemAt values 1) (head values) then
         1534|             head values
             |             ^
         1535|           else

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `system.build.toplevel':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1132:7:
         1131|     mergedValue =
         1132|       if isDefined then
             |       ^
         1133|         if all (def: type.check def.value) defsFinal then

       … while evaluating the attribute 'values'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1125:9:
         1124|       {
         1125|         values = defs''';
             |         ^
         1126|         inherit (defs'') highestPrio;

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1119:11:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |           ^
         1120|             sortProperties defs''.values

       … while calling the 'any' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1119:14:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |              ^
         1120|             sortProperties defs''.values

       … while evaluating the attribute 'values'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1252:7:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |       ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1252:16:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |                ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1099:17:
         1098|         # Process mkMerge and mkIf properties.
         1099|         defs' = concatMap (
             |                 ^
         1100|           m:

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1100:11:
         1099|         defs' = concatMap (
         1100|           m:
             |           ^
         1101|           map (

       … while calling the 'map' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1101:11:
         1100|           m:
         1101|           map (
             |           ^
         1102|             value:

       … while evaluating definitions from `/nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/activation/top-level.nix':

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/activation/top-level.nix:84:5:
           83|   baseSystemAssertWarn =
           84|     if failedAssertions != [ ] then
             |     ^
           85|       throw "\nFailed assertions:\n${concatStringsSep "\n" (map (x: "- ${x}") failedAssertions)}"

       … while calling the 'map' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/activation/top-level.nix:81:22:
           80|
           81|   failedAssertions = map (x: x.message) (filter (x: !x.assertion) config.assertions);
             |                      ^
           82|

       … while calling the 'filter' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/activation/top-level.nix:81:42:
           80|
           81|   failedAssertions = map (x: x.message) (filter (x: !x.assertion) config.assertions);
             |                                          ^
           82|

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/activation/top-level.nix:81:67:
           80|
           81|   failedAssertions = map (x: x.message) (filter (x: !x.assertion) config.assertions);
             |                                                                   ^
           82|

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `assertions':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/boot/systemd.nix':

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … while calling the 'concatLists' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/boot/systemd.nix:561:18:
          560|
          561|     assertions = concatLists (
             |                  ^
          562|       mapAttrsToList (

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/boot/systemd.nix:562:7:
          561|     assertions = concatLists (
          562|       mapAttrsToList (
             |       ^
          563|         name: service:

       … while calling 'mapAttrsToList'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1079:23:
         1078|   */
         1079|   mapAttrsToList = f: attrs: map (name: f name attrs.${name}) (attrNames attrs);
             |                       ^
         1080|

       … while calling the 'map' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1079:30:
         1078|   */
         1079|   mapAttrsToList = f: attrs: map (name: f name attrs.${name}) (attrNames attrs);
             |                              ^
         1080|

       … while calling the 'attrNames' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1079:64:
         1078|   */
         1079|   mapAttrsToList = f: attrs: map (name: f name attrs.${name}) (attrNames attrs);
             |                                                                ^
         1080|

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/boot/systemd.nix:578:9:
          577|           ])
          578|       ) cfg.services
             |         ^
          579|     );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `systemd.services':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix':

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1207:7:
         1206|     else if def._type or "" == "if" then
         1207|       if isBool def.condition then
             |       ^
         1208|         if def.condition then dischargeProperties def.content else [ ]

       … while calling the 'isBool' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1207:10:
         1206|     else if def._type or "" == "if" then
         1207|       if isBool def.condition then
             |          ^
         1208|         if def.condition then dischargeProperties def.content else [ ]

       … while evaluating the attribute 'condition'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1363:13:
         1362|     _type = "if";
         1363|     inherit condition content;
             |             ^
         1364|   };

       … while evaluating the attribute 'condition'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1363:13:
         1362|     _type = "if";
         1363|     inherit condition content;
             |             ^
         1364|   };

       … while evaluating the attribute 'condition'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1363:13:
         1362|     _type = "if";
         1363|     inherit condition content;
             |             ^
         1364|   };

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:308:21:
          307|
          308|   config = lib.mkIf cfg.enable {
             |                     ^
          309|     systemd.services.logrotate = {

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `services.logrotate.enable':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1132:7:
         1131|     mergedValue =
         1132|       if isDefined then
             |       ^
         1133|         if all (def: type.check def.value) defsFinal then

       … while evaluating the attribute 'values'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1125:9:
         1124|       {
         1125|         values = defs''';
             |         ^
         1126|         inherit (defs'') highestPrio;

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1119:11:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |           ^
         1120|             sortProperties defs''.values

       … while calling the 'any' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1119:14:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |              ^
         1120|             sortProperties defs''.values

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1119:19:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |                   ^
         1120|             sortProperties defs''.values

       … while evaluating the attribute 'value._type'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1249:67:
         1248|       strip =
         1249|         def: if def.value._type or "" == "override" then def // { value = def.value.content; } else def;
             |                                                                   ^
         1250|     in

       … while evaluating the attribute 'value.content'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1382:22:
         1381|     _type = "override";
         1382|     inherit priority content;
             |                      ^
         1383|   };

       … while evaluating the attribute 'default'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:9:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |         ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:19:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |                   ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … while calling 'foldr'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:139:14:
          138|   foldr =
          139|     op: nul: list:
             |              ^
          140|     let

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:144:5:
          143|     in
          144|     fold' 0;
             |     ^
          145|

       … while calling 'fold''
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:15:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |               ^
          143|     in

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:44:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                                            ^
          143|     in

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:33:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |                                 ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … in the left operand of the OR (||) operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:38:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |                                      ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:64:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                                                                ^
          143|     in

       … while calling 'fold''
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:15:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |               ^
          143|     in

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:44:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                                            ^
          143|     in

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:33:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |                                 ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … in the right operand of the OR (||) operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/services/logging/logrotate.nix:149:38:
          148|       enable = lib.mkEnableOption "the logrotate systemd service" // {
          149|         default = lib.foldr (n: a: a || n.enable) false (lib.attrValues cfg.settings);
             |                                      ^
          150|         defaultText = lib.literalExpression "cfg.settings != {}";

       … while calling the 'elemAt' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/lists.nix:142:48:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                                                ^
          143|     in

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:832:30:
          831|                 loc: defs:
          832|                 mapAttrs (n: v: v.value) (
             |                              ^
          833|                   filterAttrs (n: v: v ? value) (

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1148:41:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |                                         ^
         1149|   };

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1134:11:
         1133|         if all (def: type.check def.value) defsFinal then
         1134|           type.merge loc defsFinal
             |           ^
         1135|         else

       … while calling 'merge'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:1238:18:
         1237|           merge =
         1238|             loc: defs:
             |                  ^
         1239|             (base.extendModules {

       … while evaluating the attribute 'config'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:359:9:
          358|         options = checked options;
          359|         config = checked (removeAttrs config [ "_module" ]);
             |         ^
          360|         _module = checked (config._module);

       … while calling the 'seq' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:359:18:
          358|         options = checked options;
          359|         config = checked (removeAttrs config [ "_module" ]);
             |                  ^
          360|         _module = checked (config._module);

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:295:9:
          294|       checkUnmatched =
          295|         if config._module.check && config._module.freeformType == null && merged.unmatchedDefns != [ ] then
             |         ^
          296|           let

       … in the left operand of the AND (&&) operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:295:72:
          294|       checkUnmatched =
          295|         if config._module.check && config._module.freeformType == null && merged.unmatchedDefns != [ ] then
             |                                                                        ^
          296|           let

       … in the left operand of the AND (&&) operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:295:33:
          294|       checkUnmatched =
          295|         if config._module.check && config._module.freeformType == null && merged.unmatchedDefns != [ ] then
             |                                 ^
          296|           let

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:292:11:
          291|         else
          292|           recursiveUpdate freeformConfig declaredConfig;
             |           ^
          293|

       … while calling 'recursiveUpdate'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1584:10:
         1583|   recursiveUpdate =
         1584|     lhs: rhs:
             |          ^
         1585|     recursiveUpdateUntil (

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1585:5:
         1584|     lhs: rhs:
         1585|     recursiveUpdateUntil (
             |     ^
         1586|       path: lhs: rhs:

       … while calling 'recursiveUpdateUntil'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1524:16:
         1523|   recursiveUpdateUntil =
         1524|     pred: lhs: rhs:
             |                ^
         1525|     let

       … while calling the 'zipAttrsWith' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1539:5:
         1538|     in
         1539|     f [ ] [ rhs lhs ];
             |     ^
         1540|

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:283:42:
          282|             in
          283|             if defs == [ ] then { } else declaredConfig._module.freeformType.merge prefix defs;
             |                                          ^
          284|

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:831:22:
          830|                 # Non-lazy merge Function
          831|                 loc: defs:
             |                      ^
          832|                 mapAttrs (n: v: v.value) (

       … while calling the 'mapAttrs' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:832:17:
          831|                 loc: defs:
          832|                 mapAttrs (n: v: v.value) (
             |                 ^
          833|                   filterAttrs (n: v: v ? value) (

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:833:19:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … while calling 'filterAttrs'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:23:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                       ^
          658|

       … while calling the 'removeAttrs' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:28:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                            ^
          658|

       … while calling the 'filter' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:45:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                             ^
          658|

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:53:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                     ^
          658|

       … in the argument of the not operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:833:35:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:657:70:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                                      ^
          658|

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/types.nix:834:41:
          833|                   filterAttrs (n: v: v ? value) (
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)
             |                                         ^
          835|                       # Push down position info.

       … while evaluating the attribute 'optionalValue'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1148:5:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |     ^
         1149|   };

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1148:21:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |                     ^
         1149|   };

       (6 duplicate frames omitted)

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/system/boot/systemd.nix:831:31:
          830|         rotate = 1;
          831|         create = "0664 root ${config.users.groups.utmp.name}";
             |                               ^
          832|         minsize = "1M";

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `users.groups':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/config/resolvconf.nix':

       (7 duplicate frames omitted)

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/config/resolvconf.nix:173:15:
          172|
          173|     (lib.mkIf cfg.enable {
             |               ^
          174|       users.groups.resolvconf = { };

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `networking.resolvconf.enable':

       (8 duplicate frames omitted)

       … while evaluating the attribute 'default'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/config/resolvconf.nix:73:9:
           72|         type = lib.types.bool;
           73|         default = !(config.environment.etc ? "resolv.conf");
             |         ^
           74|         defaultText = lib.literalExpression ''!(config.environment.etc ? "resolv.conf")'';

       … in the argument of the not operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/config/resolvconf.nix:73:21:
           72|         type = lib.types.bool;
           73|         default = !(config.environment.etc ? "resolv.conf");
             |                     ^
           74|         defaultText = lib.literalExpression ''!(config.environment.etc ? "resolv.conf")'';

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/config/resolvconf.nix:73:21:
           72|         type = lib.types.bool;
           73|         default = !(config.environment.etc ? "resolv.conf");
             |                     ^
           74|         defaultText = lib.literalExpression ''!(config.environment.etc ? "resolv.conf")'';

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `environment.etc':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix':

       (7 duplicate frames omitted)

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:322:14:
          321|     in
          322|     lib.mkIf cfg.enabled (
             |              ^
          323|       lib.mkMerge [

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `hardware.nvidia.enabled':

       (8 duplicate frames omitted)

       … while evaluating the attribute 'default'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:30:9:
           29|         type = lib.types.bool;
           30|         default = nvidia_x11 != null;
             |         ^
           31|         defaultText = lib.literalMD "`true` if NVIDIA support is enabled";

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:9:16:
            8|   nvidiaEnabled = lib.elem "nvidia" config.services.xserver.videoDrivers;
            9|   nvidia_x11 = if nvidiaEnabled || cfg.datacenter.enable then cfg.package else null;
             |                ^
           10|

       … in the left operand of the OR (||) operator
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:9:33:
            8|   nvidiaEnabled = lib.elem "nvidia" config.services.xserver.videoDrivers;
            9|   nvidia_x11 = if nvidiaEnabled || cfg.datacenter.enable then cfg.package else null;
             |                                 ^
           10|

       … while calling the 'elem' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:8:19:
            7| let
            8|   nvidiaEnabled = lib.elem "nvidia" config.services.xserver.videoDrivers;
             |                   ^
            9|   nvidia_x11 = if nvidiaEnabled || cfg.datacenter.enable then cfg.package else null;

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/nixos/modules/hardware/video/nvidia.nix:8:37:
            7| let
            8|   nvidiaEnabled = lib.elem "nvidia" config.services.xserver.videoDrivers;
             |                                     ^
            9|   nvidia_x11 = if nvidiaEnabled || cfg.datacenter.enable then cfg.package else null;

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `services.xserver.videoDrivers':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/2ml0davi4zhsm555rfj4yq03qb01d2dl-source/modules/nixos/display/hyprland.nix':

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … from call site
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1208:31:
         1207|       if isBool def.condition then
         1208|         if def.condition then dischargeProperties def.content else [ ]
             |                               ^
         1209|       else

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while calling the 'concatMap' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1205:7:
         1204|     if def._type or "" == "merge" then
         1205|       concatMap dischargeProperties def.contents
             |       ^
         1206|     else if def._type or "" == "if" then

       … while calling 'dischargeProperties'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1207:7:
         1206|     else if def._type or "" == "if" then
         1207|       if isBool def.condition then
             |       ^
         1208|         if def.condition then dischargeProperties def.content else [ ]

       … while calling the 'isBool' builtin
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1207:10:
         1206|     else if def._type or "" == "if" then
         1207|       if isBool def.condition then
             |          ^
         1208|         if def.condition then dischargeProperties def.content else [ ]

       … while evaluating the attribute 'condition'
         at /nix/store/708n1gvb7yizlay48z15cx51ciicvv2a-source/lib/modules.nix:1363:13:
         1362|     _type = "if";
         1363|     inherit condition content;
             |             ^
         1364|   };

       error: attribute 'amd' missing
       at /nix/store/2ml0davi4zhsm555rfj4yq03qb01d2dl-source/modules/nixos/display/hyprland.nix:36:13:
           35|       (mkIf config.modules.drivers.nvidia.enable (mkDefault [ "nvidia" ]))
           36|       (mkIf config.modules.drivers.amd.enable (mkDefault [ "amdgpu" ]))
             |             ^
           37|     ];
